"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[322],{6322:(w,_,a)=>{a.r(_),a.d(_,{SearchJobsComponent:()=>D});var h=a(6396),c=a(4341),f=a(4747),u=a(987),e=a(7325),p=a(5113),g=a(5056),b=a(7355),F=a(9973),v=a(4666);function E(s,l){1&s&&(e.j41(0,"div",22)(1,"p",23),e.EFF(2," Please "),e.j41(3,"strong"),e.EFF(4,"set your preferred domain"),e.k0s(),e.EFF(5," in your profile, or "),e.j41(6,"strong"),e.EFF(7,"use the search box or filters"),e.k0s(),e.EFF(8," to find relevant jobs. "),e.k0s()())}function J(s,l){1&s&&(e.j41(0,"div",24),e.nrm(1,"div",25),e.j41(2,"div")(3,"strong"),e.EFF(4,"Loading jobs, please wait..."),e.k0s()()())}function C(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",26)(1,"div",27),e.bIt("click",function(){const o=p.eBV(t).$implicit,n=e.XpG();return p.Njj(n.openJobModal(o))}),e.j41(2,"div",28)(3,"h5",29),e.EFF(4),e.k0s(),e.j41(5,"p",30)(6,"strong"),e.EFF(7),e.k0s()(),e.j41(8,"p",31),e.EFF(9),e.k0s()()()()}if(2&s){const t=l.$implicit;e.R7$(4),e.JRh(t.title),e.R7$(3),e.JRh(t.company),e.R7$(2),e.Lme("",t.type," | ",t.location)}}function S(s,l){1&s&&e.nrm(0,"div",32)}function y(s,l){if(1&s&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.R7$(),e.JRh(t)}}function k(s,l){if(1&s&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.R7$(),e.JRh(t)}}function j(s,l){if(1&s&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.R7$(),e.JRh(t)}}function R(s,l){if(1&s&&(e.qex(0),e.j41(1,"p")(2,"strong"),e.EFF(3,"Preferred Skills:"),e.k0s()(),e.j41(4,"ul"),e.DNE(5,j,2,1,"li",43),e.k0s(),e.bVm()),2&s){const t=e.XpG(3);e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.preferredSkills)}}function M(s,l){if(1&s&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.R7$(),e.JRh(t)}}function T(s,l){if(1&s&&(e.qex(0),e.j41(1,"p")(2,"strong"),e.EFF(3,"What We Offer:"),e.k0s()(),e.j41(4,"ul"),e.DNE(5,M,2,1,"li",43),e.k0s(),e.bVm()),2&s){const t=e.XpG(3);e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.whatWeOffer)}}function A(s,l){if(1&s&&(e.j41(0,"div")(1,"p")(2,"strong"),e.EFF(3,"Overview:"),e.k0s()(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p")(7,"strong"),e.EFF(8,"Responsibilities:"),e.k0s()(),e.j41(9,"ul"),e.DNE(10,y,2,1,"li",43),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Required Skills:"),e.k0s()(),e.j41(14,"ul"),e.DNE(15,k,2,1,"li",43),e.k0s(),e.DNE(16,R,6,1,"ng-container",40)(17,T,6,1,"ng-container",40),e.k0s()),2&s){const t=e.XpG(2);e.R7$(5),e.JRh(t.selectedJob.description.overview),e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.responsibilities),e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.requiredSkills),e.R7$(),e.Y8G("ngIf",null==t.selectedJob.description.preferredSkills?null:t.selectedJob.description.preferredSkills.length),e.R7$(),e.Y8G("ngIf",null==t.selectedJob.description.whatWeOffer?null:t.selectedJob.description.whatWeOffer.length)}}function I(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",36)(4,"h5",37)(5,"strong"),e.EFF(6),e.k0s()(),e.j41(7,"button",38),e.bIt("click",function(){p.eBV(t);const o=e.XpG();return p.Njj(o.closeModal())}),e.k0s()(),e.j41(8,"div",39)(9,"p")(10,"strong"),e.EFF(11,"Company:"),e.k0s(),e.EFF(12),e.k0s(),e.j41(13,"p")(14,"strong"),e.EFF(15,"Employer Name:"),e.k0s(),e.EFF(16),e.k0s(),e.j41(17,"p")(18,"strong"),e.EFF(19,"Location:"),e.k0s(),e.EFF(20),e.k0s(),e.j41(21,"p")(22,"strong"),e.EFF(23,"Type:"),e.k0s(),e.EFF(24),e.k0s(),e.j41(25,"p")(26,"strong"),e.EFF(27,"Salary:"),e.k0s(),e.EFF(28),e.k0s(),e.j41(29,"p")(30,"strong"),e.EFF(31,"Experience Required:"),e.k0s(),e.EFF(32),e.k0s(),e.j41(33,"p")(34,"strong"),e.EFF(35,"Vacancies:"),e.k0s(),e.EFF(36),e.k0s(),e.j41(37,"p")(38,"strong"),e.EFF(39,"Status:"),e.k0s(),e.EFF(40),e.k0s(),e.DNE(41,A,18,5,"div",40),e.k0s(),e.j41(42,"div",41)(43,"button",42),e.bIt("click",function(){p.eBV(t);const o=e.XpG();return p.Njj(o.applyToJob(o.selectedJob))}),e.EFF(44,"Apply"),e.k0s()()()()()}if(2&s){const t=e.XpG();e.R7$(6),e.JRh(t.selectedJob.title),e.R7$(6),e.SpI(" ",t.selectedJob.company),e.R7$(4),e.SpI(" ",t.selectedJob.employerName),e.R7$(4),e.SpI(" ",t.selectedJob.location),e.R7$(4),e.SpI(" ",t.selectedJob.type),e.R7$(4),e.SpI(" \u20b9",t.selectedJob.salary," LPA"),e.R7$(4),e.SpI(" ",t.selectedJob.experience," Years"),e.R7$(4),e.SpI(" ",t.selectedJob.vacancies),e.R7$(4),e.SpI(" ",t.selectedJob.status),e.R7$(),e.Y8G("ngIf",t.selectedJob.description),e.R7$(2),e.Y8G("disabled",t.isApplying)}}let D=(()=>{class s{jobService;authService;applicationService;userService;allJobs=[];filteredJobs=[];searchTerm="";selectedJob=null;token=null;showModal=!1;showDomainWarning=!1;loadingJobs=!1;userId=null;isApplying=!1;filters={type:"",experience:"",expectedSalary:""};alertMessage="";alertType="info";showAlert=!1;navigateAfterAlert=!1;confirmMessage="";showConfirm=!1;pendingJobApplication=null;constructor(t,i,o,n){this.jobService=t,this.authService=i,this.applicationService=o,this.userService=n}ngOnInit(){this.searchJobs(),this.token=this.authService.getToken(),this.userId=this.authService.getUserId()}isBrowser(){return typeof window<"u"}getStoredUser(){return this.isBrowser()?this.authService.getUser():null}searchJobs(){const t=this.getStoredUser();if(!t)return void console.warn("User not found in localStorage");this.loadingJobs=!0;const i={userId:t._id},o=this.searchTerm.trim();o&&(i.search=o),this.filters.type&&(i.type=this.filters.type),this.filters.experience&&(i.experience=this.filters.experience),this.filters.expectedSalary&&(i.expectedSalary=this.filters.expectedSalary),t.preferredDomain&&"null"!==t.preferredDomain&&(i.preferredDomain=t.preferredDomain),this.showDomainWarning=!(i.type||i.experience||i.expectedSalary||i.search||i.preferredDomain),this.jobService.searchJobs(i).subscribe({next:d=>{this.allJobs=d,this.filteredJobs=[...d],this.loadingJobs=!1},error:d=>{console.error("Error fetching jobs:",d),this.loadingJobs=!1}})}openJobModal(t){this.selectedJob=t,this.showModal=!0}closeModal(){this.selectedJob=null,this.showModal=!1,this.isApplying=!1}applyToJob(t){const i=this.authService.getUserId();i?this.isApplying?this.showCustomAlert("You are already applying to a job.","info"):(this.isApplying=!0,this.userService.getUserData(i).subscribe({next:o=>{const n=o.user||o;if(!n?.name?.trim()||!n?.email?.trim()||!n?.resume)return this.showCustomAlert("Please complete your profile (name, email, and resume are required) before applying.","info"),void(this.isApplying=!1);const m=["phone","address","experience","preferredDomain"].filter(d=>!n[d]);if(m.length>0)return this.confirmMessage=`Your profile is missing recommended info (${m.join(", ")}). Apply anyway?`,this.pendingJobApplication=t,void(this.showConfirm=!0);this.submitApplication(t)},error:()=>{this.showCustomAlert("Unable to fetch user profile. Please try again.","error"),this.isApplying=!1}})):this.showCustomAlert("Please log in to apply.","info")}onConfirmApply(){this.pendingJobApplication&&(this.submitApplication(this.pendingJobApplication),this.resetConfirmState())}onCancelConfirm(){this.resetConfirmState(),this.closeModal()}resetConfirmState(){this.showConfirm=!1,this.confirmMessage="",this.pendingJobApplication=null}submitApplication(t){const i=this.getStoredUser();i&&this.token?this.applicationService.applyForJob({userId:i._id,jobId:t._id},this.token).subscribe({next:n=>{this.showCustomAlert(n.message||"Application submitted!","success"),this.closeModal(),this.searchJobs()},error:n=>{409===n.status?this.showCustomAlert("You have already applied to this job.","info"):(console.error("Application error:",n),this.showCustomAlert("Failed to apply.","error")),this.closeModal()},complete:()=>{this.isApplying=!1}}):this.isApplying=!1}showCustomAlert(t,i,o=!1){this.alertMessage=t,this.alertType=i,this.showAlert=!0,this.navigateAfterAlert=o}onAlertClosed(){this.showAlert=!1}static \u0275fac=function(i){return new(i||s)(e.rXU(g.L),e.rXU(b.u),e.rXU(F.m),e.rXU(v.D))};static \u0275cmp=e.VBU({type:s,selectors:[["app-search-jobs"]],decls:34,vars:14,consts:[[3,"closed","message","type","show"],[3,"confirmed","cancelled","show","message"],[1,"container","my-4","p-4","bg-light","rounded","shadow-sm"],[1,"mb-3"],["type","search","placeholder","Search jobs...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["value","Full-Time"],["value","Part-Time"],["value","Internship"],["value","Remote"],["type","number","placeholder","Years",1,"form-control",3,"ngModelChange","input","ngModel"],["type","number",1,"form-control",3,"ngModelChange","input","ngModel"],["class","alert alert-warning mt-3",4,"ngIf"],["class","d-flex align-items-center justify-content-center gap-3 mt-4",4,"ngIf"],[1,"row","mt-4"],["class","col-sm-6 col-md-4 col-lg-3 mb-4",4,"ngFor","ngForOf"],["class","modal-backdrop fade show",4,"ngIf"],["class","modal d-block","tabindex","-1",4,"ngIf"],[1,"alert","alert-warning","mt-3"],[1,"mb-0"],[1,"d-flex","align-items-center","justify-content-center","gap-3","mt-4"],["role","status",1,"spinner-border","text-secondary"],[1,"col-sm-6","col-md-4","col-lg-3","mb-4"],[1,"card","h-100","shadow-sm","job-card",3,"click"],[1,"card-body"],[1,"card-title","text-primary"],[1,"card-text"],[1,"card-text","text-muted"],[1,"modal-backdrop","fade","show"],["tabindex","-1",1,"modal","d-block"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-primary",3,"click","disabled"],[4,"ngFor","ngForOf"]],template:function(i,o){1&i&&(e.j41(0,"app-alert",0),e.bIt("closed",function(){return o.onAlertClosed()}),e.k0s(),e.j41(1,"app-confirm",1),e.bIt("confirmed",function(){return o.onConfirmApply()})("cancelled",function(){return o.onCancelConfirm()}),e.k0s(),e.j41(2,"div",2)(3,"div",3)(4,"input",4),e.mxI("ngModelChange",function(r){return e.DH7(o.searchTerm,r)||(o.searchTerm=r),r}),e.bIt("input",function(){return o.searchJobs()}),e.k0s()(),e.j41(5,"div",5)(6,"div",6)(7,"label",7),e.EFF(8,"Type:"),e.k0s(),e.j41(9,"select",8),e.mxI("ngModelChange",function(r){return e.DH7(o.filters.type,r)||(o.filters.type=r),r}),e.bIt("change",function(){return o.searchJobs()}),e.j41(10,"option",9),e.EFF(11,"All"),e.k0s(),e.j41(12,"option",10),e.EFF(13,"Full-Time"),e.k0s(),e.j41(14,"option",11),e.EFF(15,"Part-Time"),e.k0s(),e.j41(16,"option",12),e.EFF(17,"Internship"),e.k0s(),e.j41(18,"option",13),e.EFF(19,"Remote"),e.k0s()()(),e.j41(20,"div",6)(21,"label",7),e.EFF(22,"Experience (in Years):"),e.k0s(),e.j41(23,"input",14),e.mxI("ngModelChange",function(r){return e.DH7(o.filters.experience,r)||(o.filters.experience=r),r}),e.bIt("input",function(){return o.searchJobs()}),e.k0s()(),e.j41(24,"div",6)(25,"label",7),e.EFF(26,"Expected Salary (in LPA):"),e.k0s(),e.j41(27,"input",15),e.mxI("ngModelChange",function(r){return e.DH7(o.filters.expectedSalary,r)||(o.filters.expectedSalary=r),r}),e.bIt("input",function(){return o.searchJobs()}),e.k0s()()(),e.DNE(28,E,9,0,"div",16)(29,J,5,0,"div",17),e.j41(30,"div",18),e.DNE(31,C,10,4,"div",19),e.k0s()(),e.DNE(32,S,1,0,"div",20)(33,I,45,11,"div",21)),2&i&&(e.Y8G("message",o.alertMessage)("type",o.alertType)("show",o.showAlert),e.R7$(),e.Y8G("show",o.showConfirm)("message",o.confirmMessage),e.R7$(3),e.R50("ngModel",o.searchTerm),e.R7$(5),e.R50("ngModel",o.filters.type),e.R7$(14),e.R50("ngModel",o.filters.experience),e.R7$(4),e.R50("ngModel",o.filters.expectedSalary),e.R7$(),e.Y8G("ngIf",o.showDomainWarning&&!o.loadingJobs),e.R7$(),e.Y8G("ngIf",o.loadingJobs),e.R7$(2),e.Y8G("ngForOf",o.filteredJobs),e.R7$(),e.Y8G("ngIf",o.showModal),e.R7$(),e.Y8G("ngIf",o.showModal))},dependencies:[h.MD,h.Sq,h.bT,c.YN,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.vS,f.C,u.Y],styles:[".job-card[_ngcontent-%COMP%]{cursor:pointer}"]})}return s})()}}]);
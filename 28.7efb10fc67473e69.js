"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[28],{28:(G,u,l)=>{l.r(u),l.d(u,{ProfileComponent:()=>w});var d=l(6396),c=l(4341),_=l(6217),f=l(1249),e=l(7325),s=l(5113),g=l(2418),h=l(7355),E=l(4666),y=l(1680),v=l(345);function C(o,a){1&o&&(e.j41(0,"div",5),e.nrm(1,"div",6),e.j41(2,"div"),e.EFF(3,"Loading profile..."),e.k0s()())}function F(o,a){if(1&o&&(e.j41(0,"div",7),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.SpI(" ",t.error,"\n")}}function j(o,a){if(1&o&&e.nrm(0,"img",27),2&o){const t=e.XpG(2);e.Y8G("src","data:"+t.userOrEmployer.profilePicture.contentType+";base64,"+t.userOrEmployer.profilePicture.data,e.B4B)}}function M(o,a){1&o&&(e.j41(0,"div",28),e.EFF(1," No profile picture "),e.k0s())}function P(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Address:"),e.k0s(),e.j41(3,"input",29),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.address,r)||(n.userOrEmployer.address=r),s.Njj(r)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.address)}}function O(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Company:"),e.k0s(),e.j41(3,"input",30),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.company,r)||(n.userOrEmployer.company=r),s.Njj(r)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.company)}}function R(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Phone:"),e.k0s(),e.j41(3,"input",31),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.phone,r)||(n.userOrEmployer.phone=r),s.Njj(r)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.phone)}}function k(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Designation:"),e.k0s(),e.j41(3,"input",32),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.designation,r)||(n.userOrEmployer.designation=r),s.Njj(r)}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.designation)}}function x(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Preferred Domain:"),e.k0s(),e.j41(3,"select",33),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.preferredDomain,r)||(n.userOrEmployer.preferredDomain=r),s.Njj(r)}),e.j41(4,"option",34),e.EFF(5,"Select preferred domain"),e.k0s(),e.j41(6,"option",35),e.EFF(7,"Technology & IT"),e.k0s(),e.j41(8,"option",36),e.EFF(9,"Sales & Marketing"),e.k0s(),e.j41(10,"option",37),e.EFF(11,"Business & Management"),e.k0s(),e.j41(12,"option",38),e.EFF(13,"Finance & Accounting"),e.k0s(),e.j41(14,"option",39),e.EFF(15,"Human Resources & Recruitment"),e.k0s(),e.j41(16,"option",40),e.EFF(17,"Healthcare & Life Sciences"),e.k0s(),e.j41(18,"option",41),e.EFF(19,"Education & Training"),e.k0s(),e.j41(20,"option",42),e.EFF(21,"Engineering & Manufacturing"),e.k0s(),e.j41(22,"option",43),e.EFF(23,"Creative & Design"),e.k0s(),e.j41(24,"option",44),e.EFF(25,"Legal & Compliance"),e.k0s(),e.j41(26,"option",45),e.EFF(27,"Media & Communication"),e.k0s(),e.j41(28,"option",46),e.EFF(29,"Logistics & Supply Chain"),e.k0s(),e.j41(30,"option",47),e.EFF(31,"Customer Service & Support"),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.preferredDomain)}}function T(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",18),e.EFF(2,"Domain:"),e.k0s(),e.j41(3,"select",48),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG(2);return e.DH7(n.userOrEmployer.domain,r)||(n.userOrEmployer.domain=r),s.Njj(r)}),e.j41(4,"option",34),e.EFF(5,"Select domain"),e.k0s(),e.j41(6,"option",35),e.EFF(7,"Technology & IT"),e.k0s(),e.j41(8,"option",36),e.EFF(9,"Sales & Marketing"),e.k0s(),e.j41(10,"option",37),e.EFF(11,"Business & Management"),e.k0s(),e.j41(12,"option",38),e.EFF(13,"Finance & Accounting"),e.k0s(),e.j41(14,"option",39),e.EFF(15,"Human Resources & Recruitment"),e.k0s(),e.j41(16,"option",40),e.EFF(17,"Healthcare & Life Sciences"),e.k0s(),e.j41(18,"option",41),e.EFF(19,"Education & Training"),e.k0s(),e.j41(20,"option",42),e.EFF(21,"Engineering & Manufacturing"),e.k0s(),e.j41(22,"option",43),e.EFF(23,"Creative & Design"),e.k0s(),e.j41(24,"option",44),e.EFF(25,"Legal & Compliance"),e.k0s(),e.j41(26,"option",45),e.EFF(27,"Media & Communication"),e.k0s(),e.j41(28,"option",46),e.EFF(29,"Logistics & Supply Chain"),e.k0s(),e.j41(30,"option",47),e.EFF(31,"Customer Service & Support"),e.k0s()()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.R50("ngModel",t.userOrEmployer.domain)}}function b(o,a){if(1&o){const t=e.RV6();e.j41(0,"a",54),e.bIt("click",function(){s.eBV(t);const r=e.XpG(3);return s.Njj(r.openResume())}),e.EFF(1," View Resume "),e.k0s()}}function I(o,a){1&o&&(e.j41(0,"div",55),e.EFF(1,"No resume uploaded"),e.k0s())}function D(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",17)(1,"label",49),e.EFF(2,"Resume:"),e.k0s(),e.j41(3,"div",50),e.DNE(4,b,2,0,"a",51)(5,I,2,0,"div",52),e.k0s(),e.j41(6,"input",53),e.bIt("change",function(r){s.eBV(t);const n=e.XpG(2);return s.Njj(n.onResumeSelected(r))}),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(4),e.Y8G("ngIf",t.resumeURL),e.R7$(),e.Y8G("ngIf",!t.resumeURL)}}function S(o,a){if(1&o){const t=e.RV6();e.j41(0,"div",8)(1,"form",9),e.bIt("ngSubmit",function(){s.eBV(t);const r=e.XpG();return s.Njj(r.updateProfile())}),e.j41(2,"h2",10),e.EFF(3),e.k0s(),e.j41(4,"div",11)(5,"div",12),e.DNE(6,j,1,1,"img",13)(7,M,2,0,"div",14),e.k0s(),e.j41(8,"div",15)(9,"input",16),e.bIt("change",function(r){s.eBV(t);const n=e.XpG();return s.Njj(n.onProfilePictureSelected(r))}),e.k0s()()(),e.j41(10,"div",17)(11,"label",18),e.EFF(12,"Name:"),e.k0s(),e.j41(13,"input",19),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG();return e.DH7(n.userOrEmployer.name,r)||(n.userOrEmployer.name=r),s.Njj(r)}),e.k0s()(),e.j41(14,"div",17)(15,"label",18),e.EFF(16,"Email:"),e.k0s(),e.j41(17,"input",20),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG();return e.DH7(n.userOrEmployer.email,r)||(n.userOrEmployer.email=r),s.Njj(r)}),e.k0s()(),e.j41(18,"div",17)(19,"label",18),e.EFF(20,"Password:"),e.k0s(),e.j41(21,"input",21),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG();return e.DH7(n.userOrEmployer.password,r)||(n.userOrEmployer.password=r),s.Njj(r)}),e.k0s()(),e.DNE(22,P,4,1,"div",22)(23,O,4,1,"div",22),e.j41(24,"div",17)(25,"label",18),e.EFF(26,"Experience (years):"),e.k0s(),e.j41(27,"input",23),e.mxI("ngModelChange",function(r){s.eBV(t);const n=e.XpG();return e.DH7(n.userOrEmployer.experience,r)||(n.userOrEmployer.experience=r),s.Njj(r)}),e.k0s()(),e.DNE(28,R,4,1,"div",22)(29,k,4,1,"div",22)(30,x,32,1,"div",22)(31,T,32,1,"div",22)(32,D,7,2,"div",22),e.j41(33,"div",24)(34,"button",25),e.EFF(35,"Save Changes"),e.k0s(),e.j41(36,"button",26),e.bIt("click",function(){s.eBV(t);const r=e.XpG();return s.Njj(r.deleteProfile())}),e.EFF(37,"Delete Profile"),e.k0s()()()()}if(2&o){const t=e.XpG();e.R7$(3),e.SpI(" ","user"===t.role?"User Profile":"Employer Profile"," "),e.R7$(3),e.Y8G("ngIf",(null==t.userOrEmployer||null==t.userOrEmployer.profilePicture?null:t.userOrEmployer.profilePicture.data)&&(null==t.userOrEmployer||null==t.userOrEmployer.profilePicture?null:t.userOrEmployer.profilePicture.contentType)),e.R7$(),e.Y8G("ngIf",!(null!=t.userOrEmployer&&null!=t.userOrEmployer.profilePicture&&t.userOrEmployer.profilePicture.data)),e.R7$(6),e.R50("ngModel",t.userOrEmployer.name),e.R7$(4),e.R50("ngModel",t.userOrEmployer.email),e.R7$(4),e.R50("ngModel",t.userOrEmployer.password),e.R7$(),e.Y8G("ngIf","user"===t.role),e.R7$(),e.Y8G("ngIf","user"!==t.role),e.R7$(4),e.R50("ngModel",t.userOrEmployer.experience),e.R7$(),e.Y8G("ngIf","user"===t.role),e.R7$(),e.Y8G("ngIf","user"!==t.role),e.R7$(),e.Y8G("ngIf","user"===t.role),e.R7$(),e.Y8G("ngIf","user"!==t.role),e.R7$(),e.Y8G("ngIf","user"===t.role)}}let w=(()=>{class o{router;authService;userService;employerService;sanitizer;role=null;userOrEmployer=null;userId=null;token=null;loading=!1;error="";success="";resumeURL=null;alertMessage="";alertType="info";showAlert=!1;confirmMessage="";showConfirm=!1;deleteSuccess=!1;pendingDelete=!1;selectedBase64=null;selectedMimeType=null;previewImage=null;constructor(t,i,r,n,m){this.router=t,this.authService=i,this.userService=r,this.employerService=n,this.sanitizer=m}ngOnInit(){this.token=this.authService.getToken(),this.userId=this.authService.getUserId();const t=this.authService.getUser();this.role=t?.role??null,this.userId&&this.token&&this.role?this.fetchData():this.error="Invalid session. Please log in again."}fetchData(){this.loading=!0,"user"===this.role?this.userService.getUserData(this.userId).subscribe({next:t=>{this.userOrEmployer=t.user,this.userOrEmployer.password="",this.userOrEmployer?.resume?.data&&(this.resumeURL=this.sanitizer.bypassSecurityTrustResourceUrl(`data:${this.userOrEmployer.resume.contentType};base64,${this.userOrEmployer.resume.data}`))},error:()=>this.error="Failed to load user data.",complete:()=>this.loading=!1}):"employer"===this.role&&this.employerService.getEmployerData(this.userId,this.token).subscribe({next:t=>{this.userOrEmployer=t.employer,this.userOrEmployer.password=""},error:()=>this.error="Failed to load employer data.",complete:()=>this.loading=!1})}updateProfile(){const t={...this.userOrEmployer};t.updatedAt=(new Date).toISOString(),t.password?.trim()||delete t.password,this.selectedBase64&&this.selectedMimeType&&(t.profilePicture={data:this.selectedBase64,contentType:this.selectedMimeType}),("user"===this.role?this.userService.updateUserData(this.userId,t,this.token):this.employerService.updateEmployer(this.userId,t,this.token)).subscribe({next:r=>{this.success="Profile updated successfully!",this.showAlert=!0,this.alertMessage=this.success,this.alertType="success",this.selectedBase64=null,this.selectedMimeType=null,this.previewImage=null,typeof window<"u"&&localStorage.setItem("user",JSON.stringify(r.user||t))},error:()=>this.error="Failed to update profile."})}deleteProfile(){this.confirmMessage="Are you sure you want to delete your profile?",this.showConfirm=!0,this.pendingDelete=!0}onConfirmDelete(){("user"===this.role?this.userService.deleteUser(this.userId,this.token):this.employerService.deleteEmployer(this.userId,this.token)).subscribe({next:()=>{this.alertMessage="Profile deleted successfully.",this.alertType="success",this.showAlert=!0,this.deleteSuccess=!0,this.authService.logout()},error:()=>this.error="Failed to delete profile."}),this.showConfirm=!1}onCancelDelete(){this.showConfirm=!1,this.confirmMessage="",this.pendingDelete=!1}onAlertClosed(){this.showAlert=!1,this.deleteSuccess&&this.router.navigate(["/login"])}onProfilePictureSelected(t){const i=t.target.files?.[0];if(!i)return;if(i.size>2097152)return this.alertMessage="File size must be less than 2MB",this.alertType="info",void(this.showAlert=!0);const r=new FileReader;r.onload=()=>{const n=r.result.split(",")[1];this.selectedBase64=n,this.selectedMimeType=i.type,this.previewImage=`data:${i.type};base64,${n}`},r.readAsDataURL(i)}onResumeSelected(t){const i=t.target.files?.[0];if(!i||"user"!==this.role)return;if("application/pdf"!==i.type)return void this.showCustomAlert("Only PDF files are allowed.","info");if(i.size>2097152)return void this.showCustomAlert("File size must be less than 2MB.","info");const r=new FileReader;r.onload=()=>{const n=r.result.split(",")[1];this.userOrEmployer.resume={data:n,contentType:i.type}},r.readAsDataURL(i)}openResume(){if("user"!==this.role||!this.userOrEmployer?.resume?.data)return;const t=atob(this.userOrEmployer.resume.data),i=new Uint8Array(t.split("").map(p=>p.charCodeAt(0))),r=new Blob([i],{type:this.userOrEmployer.resume.contentType}),n=URL.createObjectURL(r);if(!window.open(n,"_blank")){const p=document.createElement("a");p.href=n,p.download="resume.pdf",p.click()}setTimeout(()=>URL.revokeObjectURL(n),1e3)}showCustomAlert(t,i){this.alertMessage=t,this.alertType=i,this.showAlert=!0}static \u0275fac=function(i){return new(i||o)(e.rXU(g.Ix),e.rXU(h.u),e.rXU(E.D),e.rXU(y.h),e.rXU(v.up))};static \u0275cmp=e.VBU({type:o,selectors:[["app-profile"]],decls:5,vars:8,consts:[[3,"closed","message","type","show"],[3,"confirmed","cancelled","message","show"],["class","d-flex align-items-center justify-content-center gap-3 p-3 fw-bold text-secondary",4,"ngIf"],["class","alert alert-danger text-center mx-auto w-100 w-md-75",4,"ngIf"],["class","container py-5",4,"ngIf"],[1,"d-flex","align-items-center","justify-content-center","gap-3","p-3","fw-bold","text-secondary"],["role","status","aria-hidden","true",1,"spinner-border"],[1,"alert","alert-danger","text-center","mx-auto","w-100","w-md-75"],[1,"container","py-5"],[1,"bg-light","p-4","rounded","shadow-sm","mx-auto",2,"max-width","700px",3,"ngSubmit"],[1,"mb-4","text-primary","text-center"],[1,"row","mb-4","align-items-center"],[1,"col-md-4","text-center","mb-3","mb-md-0"],["alt","Profile Picture","class","rounded-circle border border-primary","style","width: 120px; height: 120px; object-fit: cover;",3,"src",4,"ngIf"],["class","text-muted fst-italic",4,"ngIf"],[1,"col-md-8"],["type","file","accept","image/*",1,"form-control",3,"change"],[1,"mb-3"],[1,"form-label"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","password",1,"form-control",3,"ngModelChange","ngModel"],["class","mb-3",4,"ngIf"],["type","number","name","experience",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","mt-4","gap-3"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-danger",3,"click"],["alt","Profile Picture",1,"rounded-circle","border","border-primary",2,"width","120px","height","120px","object-fit","cover",3,"src"],[1,"text-muted","fst-italic"],["type","text","name","address",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","companyName",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","phone",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","designation",1,"form-control",3,"ngModelChange","ngModel"],["name","preferredDomain",1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","Technology & IT"],["value","Sales & Marketing"],["value","Business & Management"],["value","Finance & Accounting"],["value","Human Resources & Recruitment"],["value","Healthcare & Life Sciences"],["value","Education & Training"],["value","Engineering & Manufacturing"],["value","Creative & Design"],["value","Legal & Compliance"],["value","Media & Communication"],["value","Logistics & Supply Chain"],["value","Customer Service & Support"],["name","domain",1,"form-select",3,"ngModelChange","ngModel"],[1,"form-label","d-block"],[1,"d-flex","align-items-center","mb-2","gap-2"],["class","link-primary text-decoration-underline","target","_blank","rel","noopener noreferrer",3,"click",4,"ngIf"],["class","text-danger mb-0",4,"ngIf"],["type","file","accept","application/pdf",1,"form-control",3,"change"],["target","_blank","rel","noopener noreferrer",1,"link-primary","text-decoration-underline",3,"click"],[1,"text-danger","mb-0"]],template:function(i,r){1&i&&(e.j41(0,"app-alert",0),e.bIt("closed",function(){return r.onAlertClosed()}),e.k0s(),e.j41(1,"app-confirm",1),e.bIt("confirmed",function(){return r.onConfirmDelete()})("cancelled",function(){return r.onCancelDelete()}),e.k0s(),e.DNE(2,C,4,0,"div",2)(3,F,2,1,"div",3)(4,S,38,14,"div",4)),2&i&&(e.Y8G("message",r.alertMessage)("type",r.alertType)("show",r.showAlert),e.R7$(),e.Y8G("message",r.confirmMessage)("show",r.showConfirm),e.R7$(),e.Y8G("ngIf",r.loading),e.R7$(),e.Y8G("ngIf",r.error),e.R7$(),e.Y8G("ngIf",!r.loading&&!r.error))},dependencies:[d.MD,d.bT,c.YN,c.qT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.cb,c.YS,c.vS,c.cV,_.C,f.Y],encapsulation:2})}return o})()}}]);
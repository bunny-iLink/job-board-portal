"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[967],{967:(b,g,i)=>{i.r(g),i.d(g,{LoginComponent:()=>f});var s=i(4341),m=i(6396),d=i(4747),e=i(7325),c=i(2418),h=i(7355);function p(r,v){1&r&&(e.j41(0,"div")(1,"small",16),e.EFF(2,"Email is required and must be valid."),e.k0s()())}function _(r,v){1&r&&(e.j41(0,"div")(1,"small",16),e.EFF(2,"Password is required."),e.k0s()())}var l=function(r){return r.Success="success",r.Error="error",r.Info="info",r}(l||{});let f=(()=>{class r{fb;router;authService;loginForm;showPassword=!1;alertMessage="";alertType=l.Info;showAlert=!1;shouldNavigateAfterAlert=!1;user=null;constructor(n,o,t){this.fb=n,this.router=o,this.authService=t,this.loginForm=this.fb.group({email:["",[s.k0.required,s.k0.email]],password:["",[s.k0.required]]})}ngOnInit(){this.user=this.authService.getUser(),this.user&&this.navigateToRoleDashboard()}onSubmit(){this.loginForm.invalid||this.authService.login(this.loginForm.value).subscribe({next:o=>{console.log("Login response:",o),this.showCustomAlert("Login successful!",l.Success,!0)},error:o=>{const t=this.getErrorMessage(o.status);this.showCustomAlert(t,l.Error)}})}togglePassword(){this.showPassword=!this.showPassword}goToRegister(){this.router.navigate(["/register"])}onAlertClosed(){this.showAlert=!1,this.shouldNavigateAfterAlert&&this.navigateToRoleDashboard()}showCustomAlert(n,o,t=!1){console.log("Alert Triggered:",{message:n,type:o}),this.alertMessage=n,this.alertType=o,this.showAlert=!0,this.shouldNavigateAfterAlert=t}getErrorMessage(n){switch(n){case 400:return"Please enter both email and password.";case 404:return"No account found with this email.";case 401:return"Incorrect email or password. Please try again.";case 500:return"Server error. Please try again later.";default:return"An unexpected error occurred. Please try again later."}}navigateToRoleDashboard(){const o=(this.user||JSON.parse(localStorage.getItem("user")||"{}"))?.role;this.router.navigate([o?`/${o}/dashboard`:"/"])}static \u0275fac=function(o){return new(o||r)(e.rXU(s.ok),e.rXU(c.Ix),e.rXU(h.u))};static \u0275cmp=e.VBU({type:r,selectors:[["app-login"]],decls:27,vars:8,consts:[[3,"closed","message","type","show"],[1,"min-vh-100","position-relative","d-flex","align-items-center","justify-content-center",2,"background-image","url('login-register-bg.jpg')","background-size","cover","background-position","center top"],[1,"position-absolute","top-0","start-0","w-100","h-100","bg-dark","opacity-50"],[1,"position-relative","z-2","w-100",2,"max-width","400px"],[1,"bg-white","rounded-3","shadow","p-4","mx-3",3,"ngSubmit","formGroup"],[1,"text-center","text-primary","mb-4"],[1,"mb-3"],[1,"form-label"],["type","email","formControlName","email","required","",1,"form-control"],[4,"ngIf"],[1,"position-relative"],["formControlName","password","required","",1,"form-control",3,"type"],["type","button",1,"btn","position-absolute","top-50","end-0","translate-middle-y","me-2","p-0","border-0","bg-transparent","text-secondary",3,"click"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"],[1,"text-center","mt-3"],["role","button",1,"text-primary","text-decoration-underline",3,"click"],[1,"text-danger"]],template:function(o,t){if(1&o&&(e.j41(0,"app-alert",0),e.bIt("closed",function(){return t.onAlertClosed()}),e.k0s(),e.j41(1,"div",1),e.nrm(2,"div",2),e.j41(3,"div",3)(4,"form",4),e.bIt("ngSubmit",function(){return t.onSubmit()}),e.j41(5,"h2",5),e.EFF(6,"Login"),e.k0s(),e.j41(7,"div",6)(8,"label",7),e.EFF(9,"Email:"),e.k0s(),e.nrm(10,"input",8),e.DNE(11,p,3,0,"div",9),e.k0s(),e.j41(12,"div",6)(13,"label",7),e.EFF(14,"Password:"),e.k0s(),e.j41(15,"div",10),e.nrm(16,"input",11),e.j41(17,"button",12),e.bIt("click",function(){return t.togglePassword()}),e.EFF(18," \u{1f441} "),e.k0s()(),e.DNE(19,_,3,0,"div",9),e.k0s(),e.j41(20,"button",13),e.EFF(21," Login "),e.k0s(),e.j41(22,"div",14)(23,"span"),e.EFF(24,"New user? "),e.k0s(),e.j41(25,"a",15),e.bIt("click",function(){return t.goToRegister()}),e.EFF(26," Click here "),e.k0s()()()()()),2&o){let a,u;e.Y8G("message",t.alertMessage)("type",t.alertType)("show",t.showAlert),e.R7$(4),e.Y8G("formGroup",t.loginForm),e.R7$(7),e.Y8G("ngIf",(null==(a=t.loginForm.get("email"))?null:a.invalid)&&(null==(a=t.loginForm.get("email"))?null:a.touched)),e.R7$(5),e.Y8G("type",t.showPassword?"text":"password"),e.R7$(3),e.Y8G("ngIf",(null==(u=t.loginForm.get("password"))?null:u.invalid)&&(null==(u=t.loginForm.get("password"))?null:u.touched)),e.R7$(),e.Y8G("disabled",t.loginForm.invalid)}},dependencies:[m.MD,m.bT,s.X1,s.qT,s.me,s.BC,s.cb,s.YS,s.j4,s.JD,d.C],encapsulation:2})}return r})()}}]);
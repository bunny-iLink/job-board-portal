"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[322],{6322:(w,_,a)=>{a.r(_),a.d(_,{SearchJobsComponent:()=>P});var m=a(6396),p=a(4341),f=a(4747),g=a(987),e=a(7325),c=a(5113),u=a(5056),b=a(7355),F=a(9973),J=a(4666);function v(o,l){1&o&&(e.j41(0,"div",23)(1,"p",24),e.EFF(2," Please "),e.j41(3,"strong"),e.EFF(4,"set your preferred domain"),e.k0s(),e.EFF(5," in your profile, or "),e.j41(6,"strong"),e.EFF(7,"use the search box or filters"),e.k0s(),e.EFF(8," to find relevant jobs. "),e.k0s()())}function E(o,l){1&o&&(e.j41(0,"div",25),e.nrm(1,"div",26),e.j41(2,"div")(3,"strong"),e.EFF(4,"Loading jobs, please wait..."),e.k0s()()())}function y(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",27)(1,"div",28),e.bIt("click",function(){const i=c.eBV(t).$implicit,n=e.XpG();return c.Njj(n.openJobModal(i))}),e.j41(2,"div",29)(3,"h5",30),e.EFF(4),e.k0s(),e.j41(5,"p",31)(6,"strong"),e.EFF(7),e.k0s()(),e.j41(8,"p",32),e.EFF(9),e.k0s()()()()}if(2&o){const t=l.$implicit;e.R7$(4),e.JRh(t.title),e.R7$(3),e.JRh(t.company),e.R7$(2),e.Lme("",t.type," | ",t.location)}}function S(o,l){1&o&&e.nrm(0,"div",33)}function j(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function k(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function C(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function R(o,l){if(1&o&&(e.qex(0),e.j41(1,"p")(2,"strong"),e.EFF(3,"Preferred Skills:"),e.k0s()(),e.j41(4,"ul"),e.DNE(5,C,2,1,"li",44),e.k0s(),e.bVm()),2&o){const t=e.XpG(3);e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.preferredSkills)}}function M(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function I(o,l){if(1&o&&(e.qex(0),e.j41(1,"p")(2,"strong"),e.EFF(3,"What We Offer:"),e.k0s()(),e.j41(4,"ul"),e.DNE(5,M,2,1,"li",44),e.k0s(),e.bVm()),2&o){const t=e.XpG(3);e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.whatWeOffer)}}function T(o,l){if(1&o&&(e.j41(0,"div")(1,"p")(2,"strong"),e.EFF(3,"Overview:"),e.k0s()(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p")(7,"strong"),e.EFF(8,"Responsibilities:"),e.k0s()(),e.j41(9,"ul"),e.DNE(10,j,2,1,"li",44),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Required Skills:"),e.k0s()(),e.j41(14,"ul"),e.DNE(15,k,2,1,"li",44),e.k0s(),e.DNE(16,R,6,1,"ng-container",41)(17,I,6,1,"ng-container",41),e.k0s()),2&o){const t=e.XpG(2);e.R7$(5),e.JRh(t.selectedJob.description.overview),e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.responsibilities),e.R7$(5),e.Y8G("ngForOf",t.selectedJob.description.requiredSkills),e.R7$(),e.Y8G("ngIf",null==t.selectedJob.description.preferredSkills?null:t.selectedJob.description.preferredSkills.length),e.R7$(),e.Y8G("ngIf",null==t.selectedJob.description.whatWeOffer?null:t.selectedJob.description.whatWeOffer.length)}}function A(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",34)(1,"div",35)(2,"div",36)(3,"div",37)(4,"h5",38)(5,"strong"),e.EFF(6),e.k0s()(),e.j41(7,"button",39),e.bIt("click",function(){c.eBV(t);const i=e.XpG();return c.Njj(i.closeModal())}),e.k0s()(),e.j41(8,"div",40)(9,"p")(10,"strong"),e.EFF(11,"Company:"),e.k0s(),e.EFF(12),e.k0s(),e.j41(13,"p")(14,"strong"),e.EFF(15,"Employer Name:"),e.k0s(),e.EFF(16),e.k0s(),e.j41(17,"p")(18,"strong"),e.EFF(19,"Location:"),e.k0s(),e.EFF(20),e.k0s(),e.j41(21,"p")(22,"strong"),e.EFF(23,"Type:"),e.k0s(),e.EFF(24),e.k0s(),e.j41(25,"p")(26,"strong"),e.EFF(27,"Salary:"),e.k0s(),e.EFF(28),e.k0s(),e.j41(29,"p")(30,"strong"),e.EFF(31,"Experience Required:"),e.k0s(),e.EFF(32),e.k0s(),e.j41(33,"p")(34,"strong"),e.EFF(35,"Vacancies:"),e.k0s(),e.EFF(36),e.k0s(),e.j41(37,"p")(38,"strong"),e.EFF(39,"Status:"),e.k0s(),e.EFF(40),e.k0s(),e.DNE(41,T,18,5,"div",41),e.k0s(),e.j41(42,"div",42)(43,"button",43),e.bIt("click",function(){c.eBV(t);const i=e.XpG();return c.Njj(i.applyToJob(i.selectedJob))}),e.EFF(44,"Apply"),e.k0s()()()()()}if(2&o){const t=e.XpG();e.R7$(6),e.JRh(t.selectedJob.title),e.R7$(6),e.SpI(" ",t.selectedJob.company),e.R7$(4),e.SpI(" ",t.selectedJob.employerName),e.R7$(4),e.SpI(" ",t.selectedJob.location),e.R7$(4),e.SpI(" ",t.selectedJob.type),e.R7$(4),e.SpI(" \u20b9",t.selectedJob.salary," LPA"),e.R7$(4),e.SpI(" ",t.selectedJob.experience," Years"),e.R7$(4),e.SpI(" ",t.selectedJob.vacancies),e.R7$(4),e.SpI(" ",t.selectedJob.status),e.R7$(),e.Y8G("ngIf",t.selectedJob.description),e.R7$(2),e.Y8G("disabled",t.isApplying)}}function D(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",45)(1,"button",46),e.bIt("click",function(){c.eBV(t);const i=e.XpG();return c.Njj(i.changePage(i.pagination.page-1))}),e.EFF(2," Previous "),e.k0s(),e.j41(3,"span",47),e.EFF(4),e.k0s(),e.j41(5,"button",48),e.bIt("click",function(){c.eBV(t);const i=e.XpG();return c.Njj(i.changePage(i.pagination.page+1))}),e.EFF(6," Next "),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(),e.Y8G("disabled",1===t.pagination.page),e.R7$(3),e.Lme("Page ",t.pagination.page," of ",t.pagination.totalPages),e.R7$(),e.Y8G("disabled",t.pagination.page===t.pagination.totalPages)}}let P=(()=>{class o{jobService;authService;applicationService;userService;allJobs=[];filteredJobs=[];pagination={total:0,page:1,totalPages:1};searchTerm="";selectedJob=null;token=null;showModal=!1;showDomainWarning=!1;loadingJobs=!1;userId=null;isApplying=!1;filters={type:"",experience:"",expectedSalary:""};alertMessage="";alertType="info";showAlert=!1;navigateAfterAlert=!1;confirmMessage="";showConfirm=!1;pendingJobApplication=null;constructor(t,s,i,n){this.jobService=t,this.authService=s,this.applicationService=i,this.userService=n}ngOnInit(){this.searchJobs(),this.token=this.authService.getToken(),this.userId=this.authService.getUserId()}isBrowser(){return typeof window<"u"}getStoredUser(){return this.isBrowser()?this.authService.getUser():null}searchJobs(){const t=this.getStoredUser();if(!t)return void console.warn("User not found in localStorage");this.loadingJobs=!0;const s={userId:t._id},i=this.searchTerm.trim();i&&(s.search=i),this.filters.type&&(s.type=this.filters.type),this.filters.experience&&(s.experience=this.filters.experience),this.filters.expectedSalary&&(s.expectedSalary=this.filters.expectedSalary),t.preferredDomain&&"null"!==t.preferredDomain&&(s.preferredDomain=t.preferredDomain),this.showDomainWarning=!(s.type||s.experience||s.expectedSalary||s.search||s.preferredDomain),this.jobService.searchJobs(s).subscribe({next:d=>{this.allJobs=d.jobs||[],this.filteredJobs=[...this.allJobs],this.pagination=d.pagination||{total:0,page:1,totalPages:1},this.loadingJobs=!1},error:d=>{console.error("Error fetching jobs:",d),this.loadingJobs=!1}})}changePage(t){if(t<1||t>this.pagination.totalPages)return;const s=this.getStoredUser();if(!s)return;const i={userId:s._id,page:t},n=this.searchTerm.trim();n&&(i.search=n),this.filters.type&&(i.type=this.filters.type),this.filters.experience&&(i.experience=this.filters.experience),this.filters.expectedSalary&&(i.expectedSalary=this.filters.expectedSalary),s.preferredDomain&&"null"!==s.preferredDomain&&(i.preferredDomain=s.preferredDomain),this.loadingJobs=!0,this.jobService.searchJobs(i).subscribe({next:r=>{this.allJobs=r.jobs||[],this.filteredJobs=[...this.allJobs],this.pagination=r.pagination||{total:0,page:1,totalPages:1},this.loadingJobs=!1},error:r=>{console.error("Error fetching jobs:",r),this.loadingJobs=!1}})}openJobModal(t){this.selectedJob=t,this.showModal=!0}closeModal(){this.selectedJob=null,this.showModal=!1,this.isApplying=!1}applyToJob(t){const s=this.authService.getUserId();s?this.isApplying?this.showCustomAlert("You are already applying to a job.","info"):(this.isApplying=!0,this.userService.getUserData(s).subscribe({next:i=>{const n=i.user||i;if(!n?.name?.trim()||!n?.email?.trim()||!n?.resume)return this.showCustomAlert("Please complete your profile (name, email, and resume are required) before applying.","info"),void(this.isApplying=!1);const h=["phone","address","experience","preferredDomain"].filter(d=>!n[d]);if(h.length>0)return this.confirmMessage=`Your profile is missing recommended info (${h.join(", ")}). Apply anyway?`,this.pendingJobApplication=t,void(this.showConfirm=!0);this.submitApplication(t)},error:()=>{this.showCustomAlert("Unable to fetch user profile. Please try again.","error"),this.isApplying=!1}})):this.showCustomAlert("Please log in to apply.","info")}onConfirmApply(){this.pendingJobApplication&&(this.submitApplication(this.pendingJobApplication),this.resetConfirmState())}onCancelConfirm(){this.resetConfirmState(),this.closeModal()}resetConfirmState(){this.showConfirm=!1,this.confirmMessage="",this.pendingJobApplication=null}submitApplication(t){const s=this.getStoredUser();s&&this.token?this.applicationService.applyForJob({userId:s._id,jobId:t._id},this.token).subscribe({next:n=>{this.showCustomAlert(n.message||"Application submitted!","success"),this.closeModal(),this.searchJobs()},error:n=>{409===n.status?this.showCustomAlert("You have already applied to this job.","info"):(console.error("Application error:",n),this.showCustomAlert("Failed to apply.","error")),this.closeModal()},complete:()=>{this.isApplying=!1}}):this.isApplying=!1}showCustomAlert(t,s,i=!1){this.alertMessage=t,this.alertType=s,this.showAlert=!0,this.navigateAfterAlert=i}onAlertClosed(){this.showAlert=!1}static \u0275fac=function(s){return new(s||o)(e.rXU(u.L),e.rXU(b.u),e.rXU(F.m),e.rXU(J.D))};static \u0275cmp=e.VBU({type:o,selectors:[["app-search-jobs"]],decls:35,vars:15,consts:[[3,"closed","message","type","show"],[3,"confirmed","cancelled","show","message"],[1,"container","my-4","p-4","bg-light","rounded","shadow-sm"],[1,"mb-3"],["type","search","placeholder","Search jobs...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],["value","Full-Time"],["value","Part-Time"],["value","Internship"],["value","Remote"],["type","number","placeholder","Years",1,"form-control",3,"ngModelChange","input","ngModel"],["type","number",1,"form-control",3,"ngModelChange","input","ngModel"],["class","alert alert-warning mt-3",4,"ngIf"],["class","d-flex align-items-center justify-content-center gap-3 mt-4",4,"ngIf"],[1,"row","mt-4"],["class","col-sm-6 col-md-4 col-lg-3 mb-4",4,"ngFor","ngForOf"],["class","modal-backdrop fade show",4,"ngIf"],["class","modal d-block","tabindex","-1",4,"ngIf"],["class","d-flex justify-content-center align-items-center my-3",4,"ngIf"],[1,"alert","alert-warning","mt-3"],[1,"mb-0"],[1,"d-flex","align-items-center","justify-content-center","gap-3","mt-4"],["role","status",1,"spinner-border","text-secondary"],[1,"col-sm-6","col-md-4","col-lg-3","mb-4"],[1,"card","h-100","shadow-sm","job-card",3,"click"],[1,"card-body"],[1,"card-title","text-primary"],[1,"card-text"],[1,"card-text","text-muted"],[1,"modal-backdrop","fade","show"],["tabindex","-1",1,"modal","d-block"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-primary",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","align-items-center","my-3"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"mx-2"],[1,"btn","btn-outline-secondary","ms-2",3,"click","disabled"]],template:function(s,i){1&s&&(e.j41(0,"app-alert",0),e.bIt("closed",function(){return i.onAlertClosed()}),e.k0s(),e.j41(1,"app-confirm",1),e.bIt("confirmed",function(){return i.onConfirmApply()})("cancelled",function(){return i.onCancelConfirm()}),e.k0s(),e.j41(2,"div",2)(3,"div",3)(4,"input",4),e.mxI("ngModelChange",function(r){return e.DH7(i.searchTerm,r)||(i.searchTerm=r),r}),e.bIt("input",function(){return i.searchJobs()}),e.k0s()(),e.j41(5,"div",5)(6,"div",6)(7,"label",7),e.EFF(8,"Type:"),e.k0s(),e.j41(9,"select",8),e.mxI("ngModelChange",function(r){return e.DH7(i.filters.type,r)||(i.filters.type=r),r}),e.bIt("change",function(){return i.searchJobs()}),e.j41(10,"option",9),e.EFF(11,"All"),e.k0s(),e.j41(12,"option",10),e.EFF(13,"Full-Time"),e.k0s(),e.j41(14,"option",11),e.EFF(15,"Part-Time"),e.k0s(),e.j41(16,"option",12),e.EFF(17,"Internship"),e.k0s(),e.j41(18,"option",13),e.EFF(19,"Remote"),e.k0s()()(),e.j41(20,"div",6)(21,"label",7),e.EFF(22,"Experience (in Years):"),e.k0s(),e.j41(23,"input",14),e.mxI("ngModelChange",function(r){return e.DH7(i.filters.experience,r)||(i.filters.experience=r),r}),e.bIt("input",function(){return i.searchJobs()}),e.k0s()(),e.j41(24,"div",6)(25,"label",7),e.EFF(26,"Expected Salary (in LPA):"),e.k0s(),e.j41(27,"input",15),e.mxI("ngModelChange",function(r){return e.DH7(i.filters.expectedSalary,r)||(i.filters.expectedSalary=r),r}),e.bIt("input",function(){return i.searchJobs()}),e.k0s()()(),e.DNE(28,v,9,0,"div",16)(29,E,5,0,"div",17),e.j41(30,"div",18),e.DNE(31,y,10,4,"div",19),e.k0s()(),e.DNE(32,S,1,0,"div",20)(33,A,45,11,"div",21)(34,D,7,4,"div",22)),2&s&&(e.Y8G("message",i.alertMessage)("type",i.alertType)("show",i.showAlert),e.R7$(),e.Y8G("show",i.showConfirm)("message",i.confirmMessage),e.R7$(3),e.R50("ngModel",i.searchTerm),e.R7$(5),e.R50("ngModel",i.filters.type),e.R7$(14),e.R50("ngModel",i.filters.experience),e.R7$(4),e.R50("ngModel",i.filters.expectedSalary),e.R7$(),e.Y8G("ngIf",i.showDomainWarning&&!i.loadingJobs),e.R7$(),e.Y8G("ngIf",i.loadingJobs),e.R7$(2),e.Y8G("ngForOf",i.filteredJobs),e.R7$(),e.Y8G("ngIf",i.showModal),e.R7$(),e.Y8G("ngIf",i.showModal),e.R7$(),e.Y8G("ngIf",i.pagination.totalPages>1&&!i.loadingJobs))},dependencies:[m.MD,m.Sq,m.bT,p.YN,p.xH,p.y7,p.me,p.Q0,p.wz,p.BC,p.vS,f.C,g.Y],styles:[".job-card[_ngcontent-%COMP%]{cursor:pointer}"]})}return o})()}}]);
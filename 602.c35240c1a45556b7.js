"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[602],{5056:(E,f,a)=>{a.d(f,{L:()=>C});var _=a(9085),c=a(6052),b=a(5113);let C=(()=>{class t{http;constructor(i){this.http=i}addJob(i,p){const d=(new _.Lr).set("Authorization",`Bearer ${p}`);return this.http.post(`${c.c.apiUrl}/addJob`,i,{headers:d})}getJobSummaries(i,p){const d=(new _.Lr).set("Authorization",`Bearer ${p}`);return this.http.get(`${c.c.apiUrl}/employer/${i}/jobs-summary`,{headers:d})}getJobById(i,p){const d=(new _.Lr).set("Authorization",`Bearer ${p}`);return this.http.get(`${c.c.apiUrl}/getJobById/${i}`,{headers:d})}getJobs(i,p){const d=(new _.Lr).set("Authorization",`Bearer ${p}`);return this.http.get(`${c.c.apiUrl}/getJobs/${i}`,{headers:d})}updateJob(i,p,d){const j=(new _.Lr).set("Authorization",`Bearer ${d}`);return this.http.put(`${c.c.apiUrl}/updateJob/${i}`,p,{headers:j})}deleteJob(i,p){const d=(new _.Lr).set("Authorization",`Bearer ${p}`);return this.http.delete(`${c.c.apiUrl}/deleteJob/${i}`,{headers:d})}appliedJobs(i){return this.http.get(`${c.c.apiUrl}/appliedJobs/${i}`)}searchJobs(){return this.http.get(`${c.c.apiUrl}/searchJobs`)}searchJobsWithFilter(i){return this.http.get(`${c.c.apiUrl}/searchJobs?${i}`)}static \u0275fac=function(p){return new(p||t)(b.KVO(_.Qq))};static \u0275prov=b.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})()},9602:(E,f,a)=>{a.r(f),a.d(f,{JobDetailsComponent:()=>A});var _=a(6396),c=a(4341),b=a(1249),C=a(6217),t=a(7325),g=a(5113),i=a(4710),p=a(5056),d=a(9973),j=a(7355);function F(n,l){1&n&&(t.j41(0,"div",4),t.nrm(1,"div",5),t.j41(2,"div",6),t.EFF(3,"Loading job details and applicants..."),t.k0s()())}function v(n,l){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=l.$implicit;t.R7$(),t.JRh(e)}}function O(n,l){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=l.$implicit;t.R7$(),t.JRh(e)}}function k(n,l){1&n&&(t.j41(0,"h3"),t.EFF(1,"Preferred Skills"),t.k0s())}function M(n,l){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=l.$implicit;t.R7$(),t.JRh(e)}}function R(n,l){1&n&&(t.j41(0,"h3"),t.EFF(1,"What We Offer"),t.k0s())}function I(n,l){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=l.$implicit;t.R7$(),t.JRh(e)}}function x(n,l){if(1&n&&(t.j41(0,"section",14)(1,"h2"),t.EFF(2,"Overview"),t.k0s(),t.j41(3,"p"),t.EFF(4),t.k0s(),t.j41(5,"h3"),t.EFF(6,"Responsibilities"),t.k0s(),t.j41(7,"ul"),t.DNE(8,v,2,1,"li",15),t.k0s(),t.j41(9,"h3"),t.EFF(10,"Required Skills"),t.k0s(),t.j41(11,"ul"),t.DNE(12,O,2,1,"li",15),t.k0s(),t.DNE(13,k,2,0,"h3",16),t.j41(14,"ul"),t.DNE(15,M,2,1,"li",15),t.k0s(),t.DNE(16,R,2,0,"h3",16),t.j41(17,"ul"),t.DNE(18,I,2,1,"li",15),t.k0s()()),2&n){const e=t.XpG(2);t.R7$(4),t.JRh(e.job.description.overview),t.R7$(4),t.Y8G("ngForOf",e.job.description.responsibilities),t.R7$(4),t.Y8G("ngForOf",e.job.description.requiredSkills),t.R7$(),t.Y8G("ngIf",null==e.job.description.preferredSkills?null:e.job.description.preferredSkills.length),t.R7$(2),t.Y8G("ngForOf",e.job.description.preferredSkills),t.R7$(),t.Y8G("ngIf",null==e.job.description.whatWeOffer?null:e.job.description.whatWeOffer.length),t.R7$(2),t.Y8G("ngForOf",e.job.description.whatWeOffer)}}function D(n,l){1&n&&(t.j41(0,"div",17)(1,"p"),t.EFF(2,"No one has applied for this job yet."),t.k0s()())}function P(n,l){if(1&n){const e=t.RV6();t.j41(0,"a",24),t.bIt("click",function(){g.eBV(e);const s=t.XpG().$implicit,r=t.XpG(2);return g.Njj(r.openResume(s._id))}),t.EFF(1," View Resume "),t.k0s()}}function $(n,l){if(1&n){const e=t.RV6();t.j41(0,"div",18)(1,"p")(2,"strong"),t.EFF(3,"Name:"),t.k0s(),t.EFF(4),t.k0s(),t.j41(5,"p")(6,"strong"),t.EFF(7,"Email:"),t.k0s(),t.EFF(8),t.k0s(),t.j41(9,"p")(10,"strong"),t.EFF(11,"Contact Number:"),t.k0s(),t.EFF(12),t.k0s(),t.j41(13,"p")(14,"strong"),t.EFF(15,"Applied At:"),t.k0s(),t.EFF(16),t.nI1(17,"date"),t.k0s(),t.DNE(18,P,2,0,"a",19),t.j41(19,"p")(20,"strong"),t.EFF(21,"Status:"),t.k0s(),t.j41(22,"select",20),t.bIt("ngModelChange",function(s){const r=g.eBV(e).$implicit,m=t.XpG(2);return g.Njj(m.onStatusChange(r._id,s))}),t.j41(23,"option",21),t.EFF(24,"In Progress"),t.k0s(),t.j41(25,"option",22),t.EFF(26,"Accepted"),t.k0s(),t.j41(27,"option",23),t.EFF(28,"Rejected"),t.k0s()()()()}if(2&n){const e=l.$implicit;t.R7$(4),t.SpI(" ",(null==e.userId?null:e.userId.name)||"N/A"),t.R7$(4),t.SpI(" ",(null==e.userId?null:e.userId.email)||"N/A"),t.R7$(4),t.SpI(" ",(null==e.userId?null:e.userId.phone)||"N/A"),t.R7$(4),t.SpI(" ",t.i5U(17,6,e.appliedAt,"medium")),t.R7$(2),t.Y8G("ngIf",null==e.userId?null:e.userId.resume),t.R7$(4),t.Y8G("ngModel",e.status)}}function w(n,l){if(1&n){const e=t.RV6();t.j41(0,"div",7)(1,"h1"),t.EFF(2),t.k0s(),t.j41(3,"p")(4,"strong"),t.EFF(5,"Company:"),t.k0s(),t.EFF(6),t.k0s(),t.j41(7,"p")(8,"strong"),t.EFF(9,"Location:"),t.k0s(),t.EFF(10),t.k0s(),t.j41(11,"p")(12,"strong"),t.EFF(13,"Type:"),t.k0s(),t.EFF(14),t.k0s(),t.j41(15,"p")(16,"strong"),t.EFF(17,"Salary:"),t.k0s(),t.EFF(18),t.k0s(),t.j41(19,"p")(20,"strong"),t.EFF(21,"Experience Required:"),t.k0s(),t.EFF(22),t.k0s(),t.j41(23,"p")(24,"strong"),t.EFF(25,"Vacancies:"),t.k0s(),t.EFF(26),t.k0s(),t.j41(27,"p")(28,"strong"),t.EFF(29,"Status:"),t.k0s(),t.EFF(30),t.k0s(),t.DNE(31,x,19,7,"section",8),t.j41(32,"section",9)(33,"div",10)(34,"h2"),t.EFF(35),t.k0s(),t.j41(36,"button",11),t.bIt("click",function(){g.eBV(e);const s=t.XpG();return g.Njj(s.downloadAcceptedApplicantsCSV())}),t.EFF(37," \u2b07\ufe0f Download Accepted Applicants (CSV) "),t.k0s()(),t.nrm(38,"hr"),t.DNE(39,D,3,0,"div",12)(40,$,29,9,"div",13),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(2),t.JRh(e.job.title),t.R7$(4),t.SpI(" ",e.job.company),t.R7$(4),t.SpI(" ",e.job.location),t.R7$(4),t.SpI(" ",e.job.type),t.R7$(4),t.SpI(" ",e.job.salary),t.R7$(4),t.SpI(" ",e.job.experience," years"),t.R7$(4),t.SpI(" ",e.job.vacancies),t.R7$(4),t.SpI(" ",e.job.status),t.R7$(),t.Y8G("ngIf",e.job.description),t.R7$(4),t.SpI("Applicants (",e.applicants.length,")"),t.R7$(4),t.Y8G("ngIf",0===e.applicants.length),t.R7$(),t.Y8G("ngForOf",e.applicants)}}let A=(()=>{class n{route;jobService;applicationService;authService;jobId="";job=null;applicants=[];resumeBlobUrls={};token=null;loadingJobDetails=!1;constructor(e,o,s,r){this.route=e,this.jobService=o,this.applicationService=s,this.authService=r}alertMessage="";alertType="info";showAlert=!1;confirmMessage="";showConfirm=!1;selectedApplicationId="";newStatusToSet="";ngOnInit(){this.token=this.authService.getToken(),this.route.queryParamMap.subscribe(e=>{this.jobId=e.get("id")||"",this.jobId&&this.token&&this.loadJobDetails()})}showCustomAlert(e,o){console.log("Alert Triggered:",{message:e,type:o}),this.alertMessage=e,this.alertType=o,this.showAlert=!0}onAlertClosed(){this.showAlert=!1}loadJobDetails(){this.loadingJobDetails=!0,this.jobService.getJobById(this.jobId,this.token).subscribe({next:e=>{this.job=e.job,this.applicants=e.applicants,this.applicants.forEach(o=>{o.userId?.resume?.data&&this.createResumeBlobUrl(o)}),console.log(this.applicants)},error:e=>{console.error("Failed to load job details:",e)},complete:()=>{this.loadingJobDetails=!1}})}createResumeBlobUrl(e){try{const o=atob(e.userId.resume.data),s=new Array(o.length);for(let u=0;u<o.length;u++)s[u]=o.charCodeAt(u);const r=new Uint8Array(s),m=new Blob([r],{type:e.userId.resume.contentType});this.resumeBlobUrls[e._id]=URL.createObjectURL(m)}catch(o){console.error("Error creating resume blob URL:",o)}}openResume(e){const o=this.resumeBlobUrls[e];if(o){const s=window.open(o,"_blank");if(!s||s.closed||typeof s.closed>"u"){const r=document.createElement("a");r.href=o,r.target="_blank",r.rel="noopener noreferrer",r.download=`resume_${e}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}}}onStatusClick(e,o){this.confirmMessage=`Are you sure you want to change the status to "${o}"?`,this.selectedApplicationId=e,this.newStatusToSet=o,this.showConfirm=!0}onConfirmStatusChange(){this.applicationService.updateStatus(this.selectedApplicationId,this.token,this.newStatusToSet).subscribe({next:()=>{const e=this.applicants.find(o=>o._id===this.selectedApplicationId);e&&(e.status=this.newStatusToSet),this.resetConfirm(),this.showCustomAlert("Status changed successfuully","success")},error:e=>{console.error("Failed to update status:",e),this.resetConfirm()}})}onCancelStatusChange(){this.resetConfirm()}resetConfirm(){this.showConfirm=!1,this.selectedApplicationId="",this.newStatusToSet="",this.confirmMessage=""}ngOnDestroy(){Object.values(this.resumeBlobUrls).forEach(e=>URL.revokeObjectURL(e))}onStatusChange(e,o){this.onStatusClick(e,o)}downloadAcceptedApplicantsCSV(){const e=this.applicants.filter(h=>"Accepted"===h.status);if(0===e.length)return void this.showCustomAlert("No accepted applicants found.","info");const s=[["Name","Email","Contact Number"],...e.map(h=>[h.userId?.name||"",h.userId?.email||"",h.userId?.phone||"N/A"])].map(h=>h.map(S=>`"${String(S).replace(/"/g,'""')}"`).join(",")).join("\n"),r=new Blob([s],{type:"text/csv;charset=utf-8;"}),m=window.URL.createObjectURL(r),u=document.createElement("a");u.href=m,u.download=`accepted_applicants_${this.jobId}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(m)}static \u0275fac=function(o){return new(o||n)(t.rXU(i.nX),t.rXU(p.L),t.rXU(d.m),t.rXU(j.u))};static \u0275cmp=t.VBU({type:n,selectors:[["app-job-details"]],decls:4,vars:7,consts:[[3,"confirmed","cancelled","message","show"],[3,"closed","message","type","show"],["class","spinner-container","aria-busy","true",4,"ngIf"],["class","job-details-container",4,"ngIf"],["aria-busy","true",1,"spinner-container"],[1,"spinner"],[1,"loading-text"],[1,"job-details-container"],["class","job-section",4,"ngIf"],[1,"applicant-section"],[1,"applicant-header"],[1,"download-btn",3,"click"],["class","no-applicants",4,"ngIf"],["class","applicant-card",4,"ngFor","ngForOf"],[1,"job-section"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"no-applicants"],[1,"applicant-card"],["style","cursor: pointer;",3,"click",4,"ngIf"],[1,"status-dropdown",3,"ngModelChange","ngModel"],["value","In Progress"],["value","Accepted"],["value","Rejected"],[2,"cursor","pointer",3,"click"]],template:function(o,s){1&o&&(t.j41(0,"app-confirm",0),t.bIt("confirmed",function(){return s.onConfirmStatusChange()})("cancelled",function(){return s.onCancelStatusChange()}),t.k0s(),t.j41(1,"app-alert",1),t.bIt("closed",function(){return s.onAlertClosed()}),t.k0s(),t.DNE(2,F,4,0,"div",2)(3,w,41,12,"div",3)),2&o&&(t.Y8G("message",s.confirmMessage)("show",s.showConfirm),t.R7$(),t.Y8G("message",s.alertMessage)("type",s.alertType)("show",s.showAlert),t.R7$(),t.Y8G("ngIf",s.loadingJobDetails),t.R7$(),t.Y8G("ngIf",s.job))},dependencies:[_.MD,_.Sq,_.bT,_.vh,c.YN,c.xH,c.y7,c.wz,c.BC,c.vS,b.Y,C.C],styles:[".job-details-container[_ngcontent-%COMP%]{max-width:960px;margin:40px auto;padding:32px;background-color:#fff;border-radius:12px;box-shadow:0 8px 20px #00000014}.spinner-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;padding:1rem;font-weight:700;color:#555}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:4px solid #ccc;border-top:4px solid #555;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:1rem}.job-details-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;color:#0073e6;margin-bottom:16px}.job-details-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#444;margin:6px 0}.job-details-container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#222}.job-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .applicant-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:32px;font-size:22px;color:#333;padding-bottom:2px}.job-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:20px;font-size:18px;color:#0073e6}.job-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin-top:8px}.job-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px;color:#555}.applicant-card[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #ddd;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 2px 6px #00000008}.applicant-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0}.status-dropdown[_ngcontent-%COMP%]{padding:6px 10px;border-radius:6px;border:1px solid #ccc;background:#fff;font-size:14px;margin-top:4px}.status-dropdown[_ngcontent-%COMP%]:focus{outline:none;border-color:#0073e6;box-shadow:0 0 0 2px #0073e626}a[_ngcontent-%COMP%]{display:inline-block;margin-top:8px;color:#0073e6;text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.no-applicants[_ngcontent-%COMP%]{text-align:center;margin-top:20px;color:#777;font-style:italic}.applicant-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;margin:20px 0}.applicant-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;flex:1 1 auto}.download-btn[_ngcontent-%COMP%]{padding:8px 16px;background-color:#198754;color:#fff;border:none;border-radius:6px;font-weight:600;cursor:pointer;transition:background-color .3s ease;white-space:nowrap}@media (max-width: 600px){.applicant-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.download-btn[_ngcontent-%COMP%]{width:100%;text-align:center}}"]})}return n})()}}]);
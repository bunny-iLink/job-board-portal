"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[609],{9609:(D,p,a)=>{a.r(p),a.d(p,{UserDashboardComponent:()=>j});var c=a(6396),d=a(3560),t=a(7325),l=a(4666),h=a(7355),g=a(5056);const f=(n,i,e)=>({accepted:n,rejected:i,"in-progress":e});function b(n,i){1&n&&(t.j41(0,"div",7),t.nrm(1,"div",8),t.j41(2,"div",9),t.EFF(3,"Loading user data..."),t.k0s()())}function u(n,i){if(1&n&&(t.j41(0,"header",10)(1,"h1"),t.EFF(2),t.k0s(),t.j41(3,"p")(4,"strong"),t.EFF(5,"Email:"),t.k0s(),t.EFF(6),t.k0s()()),2&n){const e=t.XpG();t.R7$(2),t.SpI("Welcome, ",e.user.name),t.R7$(4),t.SpI(" ",e.user.email)}}function m(n,i){1&n&&(t.j41(0,"div",7),t.nrm(1,"div",8),t.j41(2,"div"),t.EFF(3,"Loading your applied jobs..."),t.k0s()())}function _(n,i){1&n&&(t.j41(0,"div",11)(1,"p"),t.EFF(2,"You haven\u2019t applied for any jobs yet."),t.k0s()())}function C(n,i){if(1&n&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td")(4,"span",15),t.EFF(5),t.k0s()()()),2&n){const e=i.$implicit;t.R7$(2),t.JRh(e.title),t.R7$(2),t.Y8G("ngClass",t.sMw(3,f,"Accepted"===e.status,"Rejected"===e.status,"In Progress"===e.status)),t.R7$(),t.SpI(" ",e.status," ")}}function O(n,i){if(1&n&&(t.j41(0,"section",12)(1,"h2"),t.EFF(2,"Your Applied Jobs"),t.k0s(),t.j41(3,"table",13)(4,"thead")(5,"tr")(6,"th"),t.EFF(7,"Job Title"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Status"),t.k0s()()(),t.j41(10,"tbody"),t.DNE(11,C,6,7,"tr",14),t.k0s()()()),2&n){const e=t.XpG();t.R7$(11),t.Y8G("ngForOf",e.appliedJobs)}}function v(n,i){if(1&n&&t.nrm(0,"div",21),2&n){const e=t.XpG(2);t.Y8G("options",e.pieChartOptions)}}function x(n,i){if(1&n&&t.nrm(0,"div",22),2&n){const e=t.XpG(2);t.Y8G("options",e.barChartOptions)}}function M(n,i){if(1&n&&(t.j41(0,"section",16)(1,"h2",17),t.EFF(2,"Application Insights"),t.k0s(),t.j41(3,"div",18),t.DNE(4,v,1,1,"div",19)(5,x,1,1,"div",20),t.k0s()()),2&n){const e=t.XpG();t.R7$(4),t.Y8G("ngIf",e.pieChartOptions),t.R7$(),t.Y8G("ngIf",e.barChartOptions)}}function P(n,i){1&n&&(t.j41(0,"div",23),t.EFF(1," Loading charts... "),t.k0s())}let j=(()=>{class n{userService;authService;jobService;user=void 0;savedJobs=[];appliedJobs=[];userId=null;token=null;pieChartOptions={};barChartOptions={};isChartLoading=!1;isUserLoading=!1;isJobsLoading=!1;constructor(e,s,o){this.userService=e,this.authService=s,this.jobService=o}ngOnInit(){if(typeof window<"u"){this.token=this.authService.getToken();const e=this.authService.getUser();e?(this.userId=e._id,this.token=this.authService.getToken(),this.userId&&this.token&&(this.loadUserData(),this.loadAppliedJobs(),this.fetchStatusChart(),this.fetchDomainChart())):console.warn("No valid employer")}}loadUserData(){if(typeof window<"u"){const e=this.authService.getUser();e&&"null"!==e?(this.userId=e._id,this.isUserLoading=!0,this.userService.getUserData(this.userId).subscribe({next:s=>{this.user=s.user,this.isUserLoading=!1},error:s=>{console.error("Failed to load user data:",s),this.user=null,this.isUserLoading=!1}})):(console.warn("No valid user in localStorage."),this.user=null,this.isUserLoading=!1)}}loadAppliedJobs(){this.userId&&(this.isJobsLoading=!0,this.jobService.appliedJobs(this.userId).subscribe({next:e=>{this.appliedJobs=e.jobs||e,console.log("Applied jobs:",this.appliedJobs),this.isJobsLoading=!1},error:e=>{console.error("Failed to load applied jobs:",e),this.isJobsLoading=!1}}))}fetchStatusChart(){this.isChartLoading=!0,this.userService.getUserStatusSummary(this.userId,this.token).subscribe({next:e=>{const s=Object.entries(e).map(([o,r])=>({name:o,value:r}));this.pieChartOptions={title:{text:"Application Status",left:"left",top:10},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"right"},series:[{name:"Applications",type:"pie",radius:"50%",data:s}]}},complete:()=>this.isChartLoading=!1,error:e=>console.error("Status chart error:",e)})}fetchDomainChart(){this.isChartLoading=!0,this.userService.getDomainSummary(this.userId,this.token).subscribe({next:e=>{const s=e.map(r=>r.domain),o=e.map(r=>r.count);this.barChartOptions={title:{text:"Applications by Job Domain"},tooltip:{},xAxis:{type:"category",data:s},yAxis:{type:"value"},series:[{data:o,type:"bar"}]}},complete:()=>this.isChartLoading=!1,error:e=>console.error("Domain chart error:",e)})}static \u0275fac=function(s){return new(s||n)(t.rXU(l.D),t.rXU(h.u),t.rXU(g.L))};static \u0275cmp=t.VBU({type:n,selectors:[["app-user-dashboard"]],features:[t.Jv_([(0,d.fM)({echarts:()=>a.e(697).then(a.bind(a,9697))})])],decls:8,vars:7,consts:[[1,"dashboard-container"],["class","spinner-container",4,"ngIf"],["class","dashboard-header",4,"ngIf"],["class","not-applied",4,"ngIf"],["class","applied-jobs",4,"ngIf"],["class","charts-section",4,"ngIf"],["class","loading",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"loading-text"],[1,"dashboard-header"],[1,"not-applied"],[1,"applied-jobs"],[1,"job-table"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"charts-section"],[1,"section-title"],[1,"chart-container"],["echarts","","class","chart pie-chart",3,"options",4,"ngIf"],["echarts","","class","chart bar-chart",3,"options",4,"ngIf"],["echarts","",1,"chart","pie-chart",3,"options"],["echarts","",1,"chart","bar-chart",3,"options"],[1,"loading"]],template:function(s,o){1&s&&(t.j41(0,"div",0),t.DNE(1,b,4,0,"div",1)(2,u,7,2,"header",2)(3,m,4,0,"div",1)(4,_,3,0,"div",3)(5,O,12,1,"section",4)(6,M,6,2,"section",5)(7,P,2,0,"div",6),t.k0s()),2&s&&(t.R7$(),t.Y8G("ngIf",o.isUserLoading),t.R7$(),t.Y8G("ngIf",!o.isUserLoading&&o.user),t.R7$(),t.Y8G("ngIf",o.isJobsLoading),t.R7$(),t.Y8G("ngIf",!o.isJobsLoading&&0===o.appliedJobs.length&&o.user),t.R7$(),t.Y8G("ngIf",!o.isJobsLoading&&o.appliedJobs.length>0),t.R7$(),t.Y8G("ngIf",!o.isChartLoading&&(o.pieChartOptions||o.barChartOptions)),t.R7$(),t.Y8G("ngIf",o.isChartLoading))},dependencies:[c.MD,c.YU,c.Sq,c.bT,d.sN,d.$P],styles:[".dashboard-container[_ngcontent-%COMP%]{max-width:960px;margin:40px auto;padding:24px;background-color:#fff;border-radius:12px;box-shadow:0 6px 18px #0000001a}.dashboard-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:10px;font-size:28px;color:#0073e6}.dashboard-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#444}.spinner-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;padding:1rem;font-weight:700;color:#555}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:4px solid #ccc;border-top:4px solid #555;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:1rem}.no-user[_ngcontent-%COMP%]{text-align:center;padding:1rem;color:#a00}.not-applied[_ngcontent-%COMP%]{text-align:center;padding:1rem;font-style:italic}.applied-jobs[_ngcontent-%COMP%]{margin-top:20px}.applied-jobs[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px;margin-bottom:12px;color:#333;border-bottom:2px solid #e0e0e0;padding-bottom:4px}.job-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:12px}.job-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .job-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:left;padding:12px 16px;border-bottom:1px solid #e0e0e0}.job-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f4f6f8;font-weight:600;color:#555}.job-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#333}.accepted[_ngcontent-%COMP%]{color:#28a745;font-weight:700}.rejected[_ngcontent-%COMP%]{color:#dc3545;font-weight:700}.in-progress[_ngcontent-%COMP%]{color:#ffc107;font-weight:700}.no-data[_ngcontent-%COMP%]{text-align:center;font-size:16px;color:#666;margin-top:40px}.not-applied[_ngcontent-%COMP%]{text-align:center}.charts-section[_ngcontent-%COMP%]{margin-top:3rem;padding:1.5rem;background-color:#fff;border-radius:12px;box-shadow:0 0 8px #0000000d}.section-title[_ngcontent-%COMP%]{text-align:center;font-size:1.8rem;margin-bottom:2rem;font-weight:600;color:#333}.chart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;align-items:center}.chart[_ngcontent-%COMP%]{width:100%;max-width:600px;height:400px}@media (min-width: 768px){.chart-container[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-around}.chart[_ngcontent-%COMP%]{width:45%}}.loading[_ngcontent-%COMP%]{text-align:center;font-weight:700;margin-top:2rem}"]})}return n})()}}]);
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[560],{560:(M,_,r)=>{r.r(_),r.d(_,{JobDetailsComponent:()=>O});var m=r(6396),p=r(4341),f=r(987),h=r(4747),b=r(6052),e=r(7325),d=r(5113),g=r(2780),j=r(5056),F=r(9973),E=r(7355);function v(o,l){1&o&&(e.j41(0,"div",4),e.nrm(1,"div",5),e.j41(2,"div"),e.EFF(3,"Loading job details and applicants..."),e.k0s()())}function I(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function C(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function k(o,l){1&o&&(e.j41(0,"h5",10),e.EFF(1,"Preferred Skills"),e.k0s())}function R(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function D(o,l){1&o&&(e.j41(0,"h5",10),e.EFF(1,"What We Offer"),e.k0s())}function S(o,l){if(1&o&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&o){const t=l.$implicit;e.R7$(),e.JRh(t)}}function y(o,l){1&o&&(e.j41(0,"div",19),e.EFF(1," No one has applied for this job yet. "),e.k0s())}function w(o,l){if(1&o){const t=e.RV6();e.j41(0,"a",33),e.bIt("click",function(){d.eBV(t);const s=e.XpG().$implicit,i=e.XpG(2);return d.Njj(i.openResume(s._id))}),e.EFF(1," View Resume "),e.k0s()}}function A(o,l){if(1&o&&e.nrm(0,"img",34),2&o){const t=e.XpG().$implicit;e.Y8G("src","data:"+t.userId.profilePicture.contentType+";base64,"+t.userId.profilePicture.data,e.B4B)}}function T(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",20)(1,"div",21)(2,"div",22)(3,"p")(4,"strong"),e.EFF(5,"Name:"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Email:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Contact Number:"),e.k0s(),e.EFF(14),e.k0s(),e.j41(15,"p")(16,"strong"),e.EFF(17,"Applied At:"),e.k0s(),e.EFF(18),e.nI1(19,"date"),e.k0s(),e.DNE(20,w,2,0,"a",23),e.j41(21,"div",24)(22,"label",25),e.EFF(23,"Status:"),e.k0s(),e.j41(24,"select",26),e.bIt("ngModelChange",function(s){const i=d.eBV(t).$implicit,u=e.XpG(2);return d.Njj(u.onStatusChange(i._id,s))}),e.j41(25,"option",27),e.EFF(26,"Applied"),e.k0s(),e.j41(27,"option",28),e.EFF(28,"In Progress"),e.k0s(),e.j41(29,"option",29),e.EFF(30,"Accepted"),e.k0s(),e.j41(31,"option",30),e.EFF(32,"Rejected"),e.k0s()()()(),e.j41(33,"div",31),e.DNE(34,A,1,1,"img",32),e.k0s()()()}if(2&o){const t=l.$implicit;e.R7$(6),e.SpI(" ",(null==t.userId?null:t.userId.name)||"N/A"),e.R7$(4),e.SpI(" ",(null==t.userId?null:t.userId.email)||"N/A"),e.R7$(4),e.SpI(" ",(null==t.userId?null:t.userId.phone)||"N/A"),e.R7$(4),e.SpI(" ",e.i5U(19,7,t.appliedAt,"medium")),e.R7$(2),e.Y8G("ngIf",null==t.userId?null:t.userId.resume),e.R7$(4),e.Y8G("ngModel",t.status),e.R7$(10),e.Y8G("ngIf",(null==t.userId||null==t.userId.profilePicture?null:t.userId.profilePicture.data)&&(null==t.userId||null==t.userId.profilePicture?null:t.userId.profilePicture.contentType))}}function $(o,l){if(1&o){const t=e.RV6();e.j41(0,"div",6)(1,"h1",7),e.EFF(2),e.k0s(),e.j41(3,"p")(4,"strong"),e.EFF(5,"Company:"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Location:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Type:"),e.k0s(),e.EFF(14),e.k0s(),e.j41(15,"p")(16,"strong"),e.EFF(17,"Salary:"),e.k0s(),e.EFF(18),e.k0s(),e.j41(19,"p")(20,"strong"),e.EFF(21,"Experience Required:"),e.k0s(),e.EFF(22),e.k0s(),e.j41(23,"p")(24,"strong"),e.EFF(25,"Vacancies:"),e.k0s(),e.EFF(26),e.k0s(),e.j41(27,"p")(28,"strong"),e.EFF(29,"Status:"),e.k0s(),e.EFF(30),e.k0s(),e.j41(31,"div",8)(32,"h4",9),e.EFF(33,"Overview"),e.k0s(),e.j41(34,"p"),e.EFF(35),e.k0s(),e.j41(36,"h5",10),e.EFF(37,"Responsibilities"),e.k0s(),e.j41(38,"ul"),e.DNE(39,I,2,1,"li",11),e.k0s(),e.j41(40,"h5",10),e.EFF(41,"Required Skills"),e.k0s(),e.j41(42,"ul"),e.DNE(43,C,2,1,"li",11),e.k0s(),e.DNE(44,k,2,0,"h5",12),e.j41(45,"ul"),e.DNE(46,R,2,1,"li",11),e.k0s(),e.DNE(47,D,2,0,"h5",12),e.j41(48,"ul"),e.DNE(49,S,2,1,"li",11),e.k0s()(),e.j41(50,"div",13)(51,"div",14)(52,"h4",15),e.EFF(53),e.k0s(),e.j41(54,"button",16),e.bIt("click",function(){d.eBV(t);const s=e.XpG();return d.Njj(s.downloadAcceptedApplicantsCSV())}),e.EFF(55," \u2b07\ufe0f Download Accepted Applicants (CSV) "),e.k0s()(),e.nrm(56,"hr"),e.DNE(57,y,2,0,"div",17)(58,T,35,10,"div",18),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(2),e.JRh(t.job.title),e.R7$(4),e.SpI(" ",t.job.company),e.R7$(4),e.SpI(" ",t.job.location),e.R7$(4),e.SpI(" ",t.job.type),e.R7$(4),e.SpI(" \u20b9",t.job.salary," LPA"),e.R7$(4),e.SpI(" ",t.job.experience," years"),e.R7$(4),e.SpI(" ",t.job.vacancies),e.R7$(4),e.SpI(" ",t.job.status),e.R7$(5),e.JRh(null==t.job.description?null:t.job.description.overview),e.R7$(4),e.Y8G("ngForOf",null==t.job.description?null:t.job.description.responsibilities),e.R7$(4),e.Y8G("ngForOf",null==t.job.description?null:t.job.description.requiredSkills),e.R7$(),e.Y8G("ngIf",null==t.job.description||null==t.job.description.preferredSkills?null:t.job.description.preferredSkills.length),e.R7$(2),e.Y8G("ngForOf",null==t.job.description?null:t.job.description.preferredSkills),e.R7$(),e.Y8G("ngIf",null==t.job.description||null==t.job.description.whatWeOffer?null:t.job.description.whatWeOffer.length),e.R7$(2),e.Y8G("ngForOf",null==t.job.description?null:t.job.description.whatWeOffer),e.R7$(4),e.SpI("Applicants (",t.applicants.length,")"),e.R7$(4),e.Y8G("ngIf",0===t.applicants.length),e.R7$(),e.Y8G("ngForOf",t.applicants)}}let O=(()=>{class o{route;jobService;applicationService;authService;jobId="";job=null;applicants=[];resumeBlobUrls={};token=null;loadingJobDetails=!1;constructor(t,n,s,i){this.route=t,this.jobService=n,this.applicationService=s,this.authService=i}alertMessage="";alertType="info";showAlert=!1;confirmMessage="";showConfirm=!1;selectedApplicationId="";newStatusToSet="";baseUrl=b.c.apiUrl;ngOnInit(){this.token=this.authService.getToken(),this.route.queryParamMap.subscribe(t=>{this.jobId=t.get("id")||"",this.jobId&&this.token&&this.loadJobDetails()})}showCustomAlert(t,n){console.log("Alert Triggered:",{message:t,type:n}),this.alertMessage=t,this.alertType=n,this.showAlert=!0}onAlertClosed(){this.showAlert=!1}loadJobDetails(){this.loadingJobDetails=!0,this.jobService.getJobById(this.jobId,this.token).subscribe({next:t=>{this.job=t.job,this.applicants=t.applicants,this.applicants.forEach(n=>{n.userId?.resume?.data&&this.createResumeBlobUrl(n)}),console.log(this.applicants)},error:t=>{console.error("Failed to load job details:",t)},complete:()=>{this.loadingJobDetails=!1}})}createResumeBlobUrl(t){try{const n=atob(t.userId.resume.data),s=new Array(n.length);for(let a=0;a<n.length;a++)s[a]=n.charCodeAt(a);const i=new Uint8Array(s),u=new Blob([i],{type:t.userId.resume.contentType});this.resumeBlobUrls[t._id]=URL.createObjectURL(u)}catch(n){console.error("Error creating resume blob URL:",n)}}openResume(t){const n=this.resumeBlobUrls[t];if(n){const s=window.open(n,"_blank");if(!s||s.closed||typeof s.closed>"u"){const i=document.createElement("a");i.href=n,i.target="_blank",i.rel="noopener noreferrer",i.download=`resume_${t}.pdf`,document.body.appendChild(i),i.click(),document.body.removeChild(i)}}}onStatusClick(t,n){this.confirmMessage=`Are you sure you want to change the status to "${n}"?`,this.selectedApplicationId=t,this.newStatusToSet=n,this.showConfirm=!0}onConfirmStatusChange(){this.applicationService.updateStatus(this.selectedApplicationId,this.token,this.newStatusToSet).subscribe({next:()=>{const t=this.applicants.find(n=>n._id===this.selectedApplicationId);t&&(t.status=this.newStatusToSet),this.resetConfirm(),this.showCustomAlert("Status changed successfuully","success")},error:t=>{console.error("Failed to update status:",t),this.resetConfirm()}})}onCancelStatusChange(){this.resetConfirm()}resetConfirm(){this.showConfirm=!1,this.selectedApplicationId="",this.newStatusToSet="",this.confirmMessage=""}ngOnDestroy(){Object.values(this.resumeBlobUrls).forEach(t=>URL.revokeObjectURL(t))}onStatusChange(t,n){this.onStatusClick(t,n)}downloadAcceptedApplicantsCSV(){const t=this.applicants.filter(c=>"Accepted"===c.status);if(0===t.length)return void this.showCustomAlert("No accepted applicants found.","info");const s=[["Name","Email","Contact Number"],...t.map(c=>[c.userId?.name||"",c.userId?.email||"",c.userId?.phone||"N/A"])].map(c=>c.map(P=>`"${String(P).replace(/"/g,'""')}"`).join(",")).join("\n"),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),u=window.URL.createObjectURL(i),a=document.createElement("a");a.href=u,a.download=`accepted_applicants_${this.jobId}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(u)}getProfilePicture(t){const n=t.userId?.profilePicture?.data;return n?`data:image/png;base64,${n}`:"assets/default-profile.png"}static \u0275fac=function(n){return new(n||o)(e.rXU(g.nX),e.rXU(j.L),e.rXU(F.m),e.rXU(E.u))};static \u0275cmp=e.VBU({type:o,selectors:[["app-job-details"]],decls:4,vars:7,consts:[[3,"confirmed","cancelled","message","show"],[3,"closed","message","type","show"],["class","d-flex justify-content-center align-items-center gap-3 p-3 fw-bold text-secondary",4,"ngIf"],["class","container mt-5 p-4 bg-white rounded shadow",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center","gap-3","p-3","fw-bold","text-secondary"],["role","status",1,"spinner-border"],[1,"container","mt-5","p-4","bg-white","rounded","shadow"],[1,"text-primary","mb-3"],[1,"mt-4"],[1,"border-bottom","pb-1"],[1,"mt-3","text-primary"],[4,"ngFor","ngForOf"],["class","mt-3 text-primary",4,"ngIf"],[1,"mt-5"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-3"],[1,"mb-0"],[1,"btn","btn-success",3,"click"],["class","text-muted fst-italic mt-3",4,"ngIf"],["class","card mt-3 shadow-sm",4,"ngFor","ngForOf"],[1,"text-muted","fst-italic","mt-3"],[1,"card","mt-3","shadow-sm"],[1,"card-body","d-flex","justify-content-between","align-items-center","flex-wrap"],[1,"flex-grow-1","pe-3"],["class","link-primary","style","cursor: pointer",3,"click",4,"ngIf"],[1,"mt-3"],[1,"form-label","fw-semibold","me-2"],[1,"form-select","w-auto","d-inline-block",3,"ngModelChange","ngModel"],["value","Applied","disabled",""],["value","In Progress"],["value","Accepted"],["value","Rejected"],[1,"d-flex","align-items-center"],["alt","Profile Picture","class","rounded-circle border border-primary","style","width: 120px; height: 120px; object-fit: cover;",3,"src",4,"ngIf"],[1,"link-primary",2,"cursor","pointer",3,"click"],["alt","Profile Picture",1,"rounded-circle","border","border-primary",2,"width","120px","height","120px","object-fit","cover",3,"src"]],template:function(n,s){1&n&&(e.j41(0,"app-confirm",0),e.bIt("confirmed",function(){return s.onConfirmStatusChange()})("cancelled",function(){return s.onCancelStatusChange()}),e.k0s(),e.j41(1,"app-alert",1),e.bIt("closed",function(){return s.onAlertClosed()}),e.k0s(),e.DNE(2,v,4,0,"div",2)(3,$,59,18,"div",3)),2&n&&(e.Y8G("message",s.confirmMessage)("show",s.showConfirm),e.R7$(),e.Y8G("message",s.alertMessage)("type",s.alertType)("show",s.showAlert),e.R7$(),e.Y8G("ngIf",s.loadingJobDetails),e.R7$(),e.Y8G("ngIf",s.job))},dependencies:[m.MD,m.Sq,m.bT,m.vh,p.YN,p.xH,p.y7,p.wz,p.BC,p.vS,f.Y,h.C],encapsulation:2})}return o})()}}]);
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[500],{1500:(O,f,l)=>{l.r(f),l.d(f,{UserProfileComponent:()=>R});var g=l(6396),a=l(4341),_=l(6217),m=l(1249),e=l(7325),i=l(5113),h=l(4666),C=l(4710),M=l(7355),P=l(345);function x(s,u){1&s&&(e.j41(0,"div",5),e.nrm(1,"div",6),e.j41(2,"div",7),e.EFF(3," Loading profile... "),e.k0s()())}function b(s,u){if(1&s&&(e.j41(0,"div",8),e.EFF(1),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.JRh(t.error)}}function v(s,u){if(1&s&&e.nrm(0,"img",47),2&s){const t=e.XpG(2);e.Y8G("src","data:"+t.user.profilePicture.contentType+";base64,"+t.user.profilePicture.data,e.B4B)}}function j(s,u){1&s&&(e.j41(0,"div",48),e.EFF(1," No profile picture "),e.k0s())}function E(s,u){if(1&s){const t=e.RV6();e.j41(0,"a",49),e.bIt("click",function(){i.eBV(t);const n=e.XpG(2);return i.Njj(n.openResume())}),e.EFF(1," View Resume "),e.k0s()}}function F(s,u){1&s&&(e.j41(0,"div"),e.EFF(1,"No resume uploaded"),e.k0s())}function y(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",9)(1,"form",10),e.bIt("ngSubmit",function(){i.eBV(t);const n=e.XpG();return i.Njj(n.updateProfile())}),e.j41(2,"h2"),e.EFF(3,"User Profile"),e.k0s(),e.j41(4,"div",11)(5,"div",12),e.DNE(6,v,1,1,"img",13)(7,j,2,0,"div",14),e.k0s(),e.j41(8,"div",15)(9,"input",16),e.bIt("change",function(n){i.eBV(t);const o=e.XpG();return i.Njj(o.onProfilePictureSelected(n))}),e.k0s()()(),e.j41(10,"label"),e.EFF(11," Name: "),e.j41(12,"input",17),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.name,n)||(o.user.name=n),i.Njj(n)}),e.k0s()(),e.j41(13,"label"),e.EFF(14," Email: "),e.j41(15,"input",18),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.email,n)||(o.user.email=n),i.Njj(n)}),e.k0s()(),e.j41(16,"label"),e.EFF(17," Password: "),e.j41(18,"input",19),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.password,n)||(o.user.password=n),i.Njj(n)}),e.k0s()(),e.j41(19,"label"),e.EFF(20," Role: "),e.j41(21,"input",20),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.role,n)||(o.user.role=n),i.Njj(n)}),e.k0s()(),e.j41(22,"label"),e.EFF(23," Address: "),e.j41(24,"input",21),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.address,n)||(o.user.address=n),i.Njj(n)}),e.k0s()(),e.j41(25,"label"),e.EFF(26," Experience (years): "),e.j41(27,"input",22),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.experience,n)||(o.user.experience=n),i.Njj(n)}),e.k0s()(),e.j41(28,"label"),e.EFF(29," Phone: "),e.j41(30,"input",23),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.phone,n)||(o.user.phone=n),i.Njj(n)}),e.k0s()(),e.j41(31,"label"),e.EFF(32," Preferred Domain: "),e.j41(33,"select",24),e.mxI("ngModelChange",function(n){i.eBV(t);const o=e.XpG();return e.DH7(o.user.preferredDomain,n)||(o.user.preferredDomain=n),i.Njj(n)}),e.j41(34,"option",25),e.EFF(35,"Select preferred domain"),e.k0s(),e.j41(36,"option",26),e.EFF(37,"Technology & IT"),e.k0s(),e.j41(38,"option",27),e.EFF(39,"Sales & Marketing"),e.k0s(),e.j41(40,"option",28),e.EFF(41,"Business & Management"),e.k0s(),e.j41(42,"option",29),e.EFF(43,"Finance & Accounting"),e.k0s(),e.j41(44,"option",30),e.EFF(45,"Human Resources & Recruitment"),e.k0s(),e.j41(46,"option",31),e.EFF(47,"Healthcare & Life Sciences"),e.k0s(),e.j41(48,"option",32),e.EFF(49,"Education & Training"),e.k0s(),e.j41(50,"option",33),e.EFF(51,"Engineering & Manufacturing"),e.k0s(),e.j41(52,"option",34),e.EFF(53,"Creative & Design"),e.k0s(),e.j41(54,"option",35),e.EFF(55,"Legal & Compliance"),e.k0s(),e.j41(56,"option",36),e.EFF(57,"Media & Communication"),e.k0s(),e.j41(58,"option",37),e.EFF(59,"Logistics & Supply Chain"),e.k0s(),e.j41(60,"option",38),e.EFF(61,"Customer Service & Support"),e.k0s()()(),e.j41(62,"div",39)(63,"div",40),e.DNE(64,E,2,0,"a",41)(65,F,2,0,"div",42),e.k0s(),e.j41(66,"div",15)(67,"input",43),e.bIt("change",function(n){i.eBV(t);const o=e.XpG();return i.Njj(o.onResumeSelected(n))}),e.k0s()()(),e.j41(68,"div",44)(69,"button",45),e.EFF(70,"Save Changes"),e.k0s(),e.j41(71,"button",46),e.bIt("click",function(){i.eBV(t);const n=e.XpG();return i.Njj(n.deleteProfile())}),e.EFF(72,"Delete Profile"),e.k0s()()()()}if(2&s){const t=e.XpG();e.R7$(6),e.Y8G("ngIf",(null==t.user||null==t.user.profilePicture?null:t.user.profilePicture.data)&&(null==t.user||null==t.user.profilePicture?null:t.user.profilePicture.contentType)),e.R7$(),e.Y8G("ngIf",!(null!=t.user&&null!=t.user.profilePicture&&t.user.profilePicture.data)),e.R7$(5),e.R50("ngModel",t.user.name),e.R7$(3),e.R50("ngModel",t.user.email),e.R7$(3),e.R50("ngModel",t.user.password),e.R7$(3),e.R50("ngModel",t.user.role),e.R7$(3),e.R50("ngModel",t.user.address),e.R7$(3),e.R50("ngModel",t.user.experience),e.R7$(3),e.R50("ngModel",t.user.phone),e.R7$(3),e.R50("ngModel",t.user.preferredDomain),e.R7$(31),e.Y8G("ngIf",t.resumeURL),e.R7$(),e.Y8G("ngIf",!t.resumeURL)}}let R=(()=>{class s{userService;router;authService;sanitizer;userId=null;user=null;loading=!1;error="";success="";token=null;resumeURL=null;alertMessage="";alertType="info";showAlert=!1;deleteSuccess=!1;confirmMessage="";showConfirm=!1;pendingDelete=!1;showCustomAlert(t,r){console.log("Alert Triggered:",{message:t,type:r}),this.alertMessage=t,this.alertType=r,this.showAlert=!0}onAlertClosed(){this.showAlert=!1,this.deleteSuccess&&this.router.navigate(["/login"])}constructor(t,r,n,o){this.userService=t,this.router=r,this.authService=n,this.sanitizer=o}ngOnInit(){this.userId=this.authService.getUserId(),this.token=this.authService.getToken(),this.userId?this.fetchuser():this.error="No user ID found."}fetchuser(){this.loading=!0,this.userService.getUserData(this.userId).subscribe({next:t=>{this.user=t.user,this.user&&(this.user.password="",this.user?.resume?.data)&&(this.resumeURL=this.sanitizer.bypassSecurityTrustResourceUrl(`data:${this.user.resume.contentType};base64,${this.user.resume.data}`)),this.loading=!1},error:()=>{this.error="Failed to load user data.",this.loading=!1}})}updateProfile(){if(!this.userId)return;this.success="",this.error="";const t={...this.user};t.updatedAt=(new Date).toISOString(),(!t.password||""===t.password.trim())&&delete t.password,this.userService.updateUserData(this.userId,t,this.token).subscribe({next:r=>{this.success="Profile updated successfully!",this.showCustomAlert(this.success,"success"),typeof window<"u"&&localStorage.setItem("user",JSON.stringify(r.user||t))},error:()=>{this.error="Failed to update profile."}})}deleteProfile(){this.confirmMessage="Are you sure you want to delete your profile? This action cannot be undone.",this.showConfirm=!0,this.pendingDelete=!0}onConfirmDelete(){this.pendingDelete&&this.userId&&this.token&&this.userService.deleteUser(this.userId,this.token).subscribe({next:()=>{this.showCustomAlert("Profile deleted successfully.","success"),typeof window<"u"&&(localStorage.removeItem("id"),localStorage.removeItem("token")),this.deleteSuccess=!0},error:()=>{this.error="Failed to delete profile."}}),this.resetConfirm()}onCancelConfirm(){this.resetConfirm()}resetConfirm(){this.showConfirm=!1,this.confirmMessage="",this.pendingDelete=!1}onProfilePictureSelected(t){const r=t.target.files?.[0];if(r){const n=new FileReader;n.onload=()=>{const o=n.result.split(",")[1];this.user.profilePicture={data:o,contentType:r.type}},n.readAsDataURL(r)}}onResumeSelected(t){const r=t.target.files?.[0];if(r){if("application/pdf"!==r.type)return void this.showCustomAlert("Only PDF files are allowed.","info");if(r.size>2097152)return void this.showCustomAlert("File size must be less than 2MB.","info");const n=new FileReader;n.onload=()=>{const o=n.result.split(",")[1];this.user.resume={data:o,contentType:r.type},console.log(this.user.resume)},n.readAsDataURL(r)}}openResume(){if(!this.user?.resume?.data)return;const t=atob(this.user.resume.data),r=new Array(t.length);for(let c=0;c<t.length;c++)r[c]=t.charCodeAt(c);const n=new Uint8Array(r),o=new Blob([n],{type:this.user.resume.contentType}),p=URL.createObjectURL(o),d=window.open(p,"_blank");if(!d||d.closed||typeof d.closed>"u"){const c=document.createElement("a");c.href=p,c.target="_blank",c.rel="noopener noreferrer",c.download="resume.pdf",document.body.appendChild(c),c.click(),document.body.removeChild(c)}setTimeout(()=>URL.revokeObjectURL(p),1e3)}static \u0275fac=function(r){return new(r||s)(e.rXU(h.D),e.rXU(C.Ix),e.rXU(M.u),e.rXU(P.up))};static \u0275cmp=e.VBU({type:s,selectors:[["app-user-profile"]],decls:5,vars:8,consts:[[3,"closed","message","type","show"],[3,"confirmed","cancelled","message","show"],["class","spinner-container",4,"ngIf"],["class","error",4,"ngIf"],["class","profile-container",4,"ngIf"],[1,"spinner-container"],[1,"spinner"],[1,"loading-text"],[1,"error"],[1,"profile-container"],[3,"ngSubmit"],[1,"profile-picture-section"],[1,"current-picture"],["alt","Profile Picture","class","profile-picture",3,"src",4,"ngIf"],["class","no-picture",4,"ngIf"],[1,"upload-section"],["type","file","accept","image/*",3,"change"],["type","text","name","name","required","",3,"ngModelChange","ngModel"],["type","email","name","email","required","",3,"ngModelChange","ngModel"],["type","password","name","password",3,"ngModelChange","ngModel"],["type","text","name","role","readonly","",3,"ngModelChange","ngModel"],["type","text","name","company",3,"ngModelChange","ngModel"],["type","number","name","experience",3,"ngModelChange","ngModel"],["type","text","name","designation",3,"ngModelChange","ngModel"],["id","preferredDomain","name","preferredDomain",3,"ngModelChange","ngModel"],["value",""],["value","Technology & IT"],["value","Sales & Marketing"],["value","Business & Management"],["value","Finance & Accounting"],["value","Human Resources & Recruitment"],["value","Healthcare & Life Sciences"],["value","Education & Training"],["value","Engineering & Manufacturing"],["value","Creative & Design"],["value","Legal & Compliance"],["value","Media & Communication"],["value","Logistics & Supply Chain"],["value","Customer Service & Support"],[1,"resume-section"],[1,"current-resume"],["target","_blank","rel","noopener noreferrer",3,"click",4,"ngIf"],[4,"ngIf"],["type","file","accept","application/pdf",3,"change"],[1,"buttons"],["type","submit"],["type","button",1,"delete-btn",3,"click"],["alt","Profile Picture",1,"profile-picture",3,"src"],[1,"no-picture"],["target","_blank","rel","noopener noreferrer",3,"click"]],template:function(r,n){1&r&&(e.j41(0,"app-alert",0),e.bIt("closed",function(){return n.onAlertClosed()}),e.k0s(),e.j41(1,"app-confirm",1),e.bIt("confirmed",function(){return n.onConfirmDelete()})("cancelled",function(){return n.onCancelConfirm()}),e.k0s(),e.DNE(2,x,4,0,"div",2)(3,b,2,1,"div",3)(4,y,73,12,"div",4)),2&r&&(e.Y8G("message",n.alertMessage)("type",n.alertType)("show",n.showAlert),e.R7$(),e.Y8G("message",n.confirmMessage)("show",n.showConfirm),e.R7$(),e.Y8G("ngIf",n.loading),e.R7$(),e.Y8G("ngIf",n.error),e.R7$(),e.Y8G("ngIf",!n.loading&&!n.error))},dependencies:[g.MD,g.bT,a.YN,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.YS,a.vS,a.cV,_.C,m.Y],styles:[".profile-container[_ngcontent-%COMP%]{max-width:700px;margin:40px auto;padding:24px;background-color:#f9f9f9;border-radius:12px;box-shadow:0 4px 12px #0000001a}h2[_ngcontent-%COMP%]{margin-bottom:24px;color:#0073e6;text-align:center}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%], .success[_ngcontent-%COMP%]{text-align:center;padding:12px;margin:16px auto;width:100%;max-width:700px;border-radius:6px;font-weight:500}.spinner-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;padding:1rem;font-weight:700;color:#555}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:4px solid #ccc;border-top:4px solid #555;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-text[_ngcontent-%COMP%]{font-size:1rem}.error[_ngcontent-%COMP%]{background-color:#ffe6e6;color:#d8000c}.success[_ngcontent-%COMP%]{color:#28a745}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:14px;font-weight:500}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;margin-top:6px;border:1px solid #ccc;border-radius:6px;font-size:15px}.profile-picture-section[_ngcontent-%COMP%]{display:flex;gap:24px;align-items:center;margin-bottom:24px;flex-wrap:wrap}.current-picture[_ngcontent-%COMP%]{flex:1;text-align:center}.profile-picture[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;object-fit:cover;border:2px solid #0073e6}.no-picture[_ngcontent-%COMP%]{color:#888;font-style:italic}.upload-section[_ngcontent-%COMP%]{flex:2;display:flex;flex-direction:column;gap:10px}.resume-section[_ngcontent-%COMP%]{margin-top:24px;display:flex;flex-direction:column;gap:10px}.current-resume[_ngcontent-%COMP%]{margin-bottom:8px}.current-resume[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#0073e6;text-decoration:underline}.current-resume[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#005bb5}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:24px;gap:16px}button[_ngcontent-%COMP%]{padding:10px 16px;background-color:#0073e6;color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:background-color .2s}button[_ngcontent-%COMP%]:hover{background-color:#005bb5}.delete-btn[_ngcontent-%COMP%]{background-color:#d9534f}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#c9302c}"]})}return s})()}}]);